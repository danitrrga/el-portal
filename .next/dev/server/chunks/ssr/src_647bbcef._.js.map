{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/20252128/dev/Projects/el-portal/src/components/GoalFormModal.tsx"],"sourcesContent":["\nimport React, { useState, useEffect } from 'react';\nimport { Goal, GoalType, Habit } from '@/types/types';\nimport { CheckCircle2, X, Link as LinkIcon, Search, Check } from 'lucide-react';\n\ninterface GoalFormModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onSave: (\n        goal: { title: string; description: string; type: GoalType; subtasks?: string[] },\n        selectedHabit: Habit | null\n    ) => void;\n    initialGoal?: Goal;\n    currentCycleHabits: Habit[];\n    allHabits: Habit[];\n}\n\nexport const GoalFormModal: React.FC<GoalFormModalProps> = ({\n    isOpen, onClose, onSave, initialGoal, currentCycleHabits, allHabits\n}) => {\n    const [title, setTitle] = useState('');\n    const [description, setDescription] = useState('');\n    const [type, setType] = useState<GoalType>(GoalType.TASK_PROJECT);\n    const [subtasks, setSubtasks] = useState('');\n    const [selectedHabit, setSelectedHabit] = useState<Habit | null>(null);\n    const [habitTab, setHabitTab] = useState<'current' | 'database'>('current');\n    const [habitSearch, setHabitSearch] = useState('');\n\n    useEffect(() => {\n        if (initialGoal) {\n            setTitle(initialGoal.title);\n            setDescription(initialGoal.description);\n            setType(initialGoal.type);\n            // Convert subtasks array to string with indentation preservation\n            if (initialGoal.subtasks) {\n                setSubtasks(initialGoal.subtasks.map(t => {\n                    const indent = \"  \".repeat(t.level || 0);\n                    return `${indent}${t.name}`;\n                }).join('\\n'));\n            } else {\n                setSubtasks('');\n            }\n            // Link habit if ID exists\n            if (initialGoal.linked_habit_id) {\n                const found = allHabits.find(h => h.id === initialGoal.linked_habit_id);\n                if (found) setSelectedHabit(found);\n            }\n        } else {\n            // Reset for Add Mode\n            setTitle('');\n            setDescription('');\n            setType(GoalType.TASK_PROJECT);\n            setSubtasks('');\n            setSelectedHabit(null);\n        }\n    }, [initialGoal, isOpen]);\n\n    if (!isOpen) return null;\n\n    const uniqueDbHabits = Array.from(new Map(allHabits.map(h => [h.name, h])).values());\n    const displayHabits = habitTab === 'current' ? currentCycleHabits : uniqueDbHabits;\n    const filteredHabits = displayHabits.filter(h => h.name.toLowerCase().includes(habitSearch.toLowerCase()));\n\n    const handleSave = () => {\n        if (!title.trim()) return;\n        const subtaskList = type === GoalType.TASK_PROJECT ? subtasks.split('\\n').filter(s => s.trim().length > 0) : undefined;\n        onSave({ title, description, type, subtasks: subtaskList }, selectedHabit);\n    };\n\n    const handleKeyDown = (e: React.KeyboardEvent<HTMLTextAreaElement>) => {\n        if (e.key === 'Tab') {\n            e.preventDefault();\n            const start = e.currentTarget.selectionStart;\n            const end = e.currentTarget.selectionEnd;\n            const value = e.currentTarget.value;\n            const indent = \"  \";\n            const newValue = value.substring(0, start) + indent + value.substring(end);\n            setSubtasks(newValue);\n            requestAnimationFrame(() => {\n                if (e.currentTarget) {\n                    e.currentTarget.selectionStart = e.currentTarget.selectionEnd = start + indent.length;\n                }\n            });\n        }\n    };\n\n    return (\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-graphite-950/80 backdrop-blur-sm p-4\" onClick={onClose}>\n            <div className=\"w-full max-w-xl rounded-2xl bg-white dark:bg-graphite-900 shadow-2xl animate-in zoom-in-95 duration-200 border border-graphite-200 dark:border-graphite-800 flex flex-col max-h-[90vh]\" onClick={(e) => e.stopPropagation()}>\n                <div className=\"p-6 border-b border-graphite-200 dark:border-graphite-800 flex justify-between items-center\">\n                    <h2 className=\"text-xl font-bold text-graphite-900 dark:text-white flex items-center gap-2\">\n                        <CheckCircle2 size={20} className=\"text-pacific-500\" />\n                        {initialGoal ? 'Edit Goal' : 'Add New Goal'}\n                    </h2>\n                    <button onClick={onClose} className=\"text-graphite-400 hover:text-white\"><X size={20} /></button>\n                </div>\n                <div className=\"p-6 overflow-y-auto space-y-5\">\n                    <div className=\"space-y-4\">\n                        <div>\n                            <label className=\"block text-xs font-bold text-graphite-500 uppercase mb-1.5\">Goal Title</label>\n                            <input value={title} onChange={e => setTitle(e.target.value)} className=\"w-full bg-graphite-50 dark:bg-graphite-800 border border-graphite-200 dark:border-graphite-700 rounded-xl px-4 py-3 text-sm focus:outline-none focus:border-pacific-500 text-graphite-900 dark:text-white\" placeholder=\"e.g. Launch Marketing Campaign\" autoFocus />\n                        </div>\n                        <div>\n                            <label className=\"block text-xs font-bold text-graphite-500 uppercase mb-1.5\">Description</label>\n                            <textarea value={description} onChange={e => setDescription(e.target.value)} rows={2} className=\"w-full bg-graphite-50 dark:bg-graphite-800 border border-graphite-200 dark:border-graphite-700 rounded-xl px-4 py-3 text-sm focus:outline-none focus:border-pacific-500 text-graphite-900 dark:text-white resize-none\" placeholder=\"What is the objective?\" />\n                        </div>\n                    </div>\n                    <div>\n                        <label className=\"block text-xs font-bold text-graphite-500 uppercase mb-2\">Goal Type</label>\n                        <div className=\"grid grid-cols-2 gap-2 p-1 bg-graphite-100 dark:bg-graphite-800 rounded-xl\">\n                            <button onClick={() => setType(GoalType.TASK_PROJECT)} className={`py-2 rounded-lg text-sm font-bold transition-all ${type === GoalType.TASK_PROJECT ? 'bg-white dark:bg-graphite-700 text-pacific-600 dark:text-white shadow-sm' : 'text-graphite-500 hover:text-graphite-700 dark:hover:text-graphite-300'}`}>Project (Tasks)</button>\n                            <button onClick={() => setType(GoalType.CONSISTENCY_METRIC)} className={`py-2 rounded-lg text-sm font-bold transition-all ${type === GoalType.CONSISTENCY_METRIC ? 'bg-white dark:bg-graphite-700 text-pacific-600 dark:text-white shadow-sm' : 'text-graphite-500 hover:text-graphite-700 dark:hover:text-graphite-300'}`}>Habit Metric</button>\n                        </div>\n                    </div>\n                    {type === GoalType.TASK_PROJECT ? (\n                        <div className=\"animate-in fade-in slide-in-from-top-2\">\n                            <label className=\"block text-xs font-bold text-graphite-500 uppercase mb-1.5\">Action Plan (Subtasks)</label>\n                            <textarea value={subtasks} onChange={e => setSubtasks(e.target.value)} onKeyDown={handleKeyDown} rows={6} className=\"w-full bg-graphite-50 dark:bg-graphite-800 border border-graphite-200 dark:border-graphite-700 rounded-xl px-4 py-3 text-sm font-mono focus:outline-none focus:border-pacific-500 text-graphite-900 dark:text-white leading-relaxed\" placeholder=\"- Research competitors&#10;  - Analyze pricing (Indented with Tab)&#10;- Draft copy\" />\n                            <p className=\"text-[10px] text-graphite-400 mt-1 text-right\">Use Tab to indent sub-tasks</p>\n                        </div>\n                    ) : (\n                        <div className=\"animate-in fade-in slide-in-from-top-2 p-4 border border-graphite-200 dark:border-graphite-700 rounded-xl bg-graphite-50 dark:bg-graphite-800/50\">\n                            <label className=\"block text-xs font-bold text-pacific-500 uppercase mb-3 flex items-center gap-2\"><LinkIcon size={14} /> Link Habit Source</label>\n                            <div className=\"flex gap-4 mb-3 border-b border-graphite-200 dark:border-graphite-700\">\n                                <button onClick={() => setHabitTab('current')} className={`pb-2 text-xs font-bold uppercase transition-colors border-b-2 ${habitTab === 'current' ? 'border-pacific-500 text-pacific-600 dark:text-pacific-400' : 'border-transparent text-graphite-400'}`}>Current Cycle</button>\n                                <button onClick={() => setHabitTab('database')} className={`pb-2 text-xs font-bold uppercase transition-colors border-b-2 ${habitTab === 'database' ? 'border-pacific-500 text-pacific-600 dark:text-pacific-400' : 'border-transparent text-graphite-400'}`}>Database Search</button>\n                            </div>\n                            {habitTab === 'database' && (\n                                <div className=\"relative mb-3\">\n                                    <Search size={14} className=\"absolute left-3 top-1/2 -translate-y-1/2 text-graphite-400\" />\n                                    <input value={habitSearch} onChange={e => setHabitSearch(e.target.value)} className=\"w-full bg-white dark:bg-graphite-900 border border-graphite-200 dark:border-graphite-700 rounded-lg pl-9 pr-3 py-2 text-sm focus:outline-none focus:border-pacific-500\" placeholder=\"Search habit history...\" />\n                                </div>\n                            )}\n                            <div className=\"max-h-40 overflow-y-auto space-y-1 pr-1\">\n                                {filteredHabits.map(h => (\n                                    <button key={h.id} onClick={() => setSelectedHabit(h)} className={`w-full text-left px-3 py-2 rounded-lg text-sm transition-all flex justify-between items-center ${selectedHabit?.name === h.name ? 'bg-pacific-500 text-white shadow-md' : 'hover:bg-graphite-200 dark:hover:bg-graphite-700 text-graphite-700 dark:text-graphite-300'}`}>\n                                        <span className=\"font-medium truncate\">{h.name}</span>\n                                        {selectedHabit?.name === h.name && <Check size={14} />}\n                                    </button>\n                                ))}\n                                {filteredHabits.length === 0 && <div className=\"text-center py-4 text-xs text-graphite-400 italic\">No habits found.</div>}\n                            </div>\n                            {selectedHabit && (\n                                <div className=\"mt-3 pt-3 border-t border-graphite-200 dark:border-graphite-700 flex items-center justify-between\">\n                                    <span className=\"text-xs text-graphite-500\">Selected: <span className=\"font-bold text-graphite-900 dark:text-white\">{selectedHabit.name}</span></span>\n                                    <button onClick={() => setSelectedHabit(null)} className=\"text-xs text-red-400 hover:text-red-500\">Clear</button>\n                                </div>\n                            )}\n                        </div>\n                    )}\n                </div>\n                <div className=\"p-6 border-t border-graphite-200 dark:border-graphite-800 flex justify-end gap-3\">\n                    <button onClick={onClose} className=\"px-4 py-2 text-sm font-bold text-graphite-500 hover:text-graphite-800 dark:hover:text-white transition-colors\">Cancel</button>\n                    <button onClick={handleSave} disabled={!title.trim() || (type === GoalType.CONSISTENCY_METRIC && !selectedHabit)} className=\"px-6 py-2 bg-pacific-600 text-white rounded-xl text-sm font-bold shadow-lg shadow-pacific-500/30 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-pacific-500 transition-colors\">\n                        {initialGoal ? 'Save Changes' : 'Create Goal'}\n                    </button>\n                </div>\n            </div>\n        </div>\n    );\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 494, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/20252128/dev/Projects/el-portal/src/components/HabitFormModal.tsx"],"sourcesContent":["\nimport React, { useState, useEffect, useMemo } from 'react';\nimport { Habit, HabitWeight } from '@/types/types';\nimport { CheckCircle2, X, Save, Library, Plus, Search, Tag, Trash2, ArrowRight, Settings, Edit2, ArrowLeft, AlertCircle, Check } from 'lucide-react';\n\ninterface HabitFormModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onSave: (habitData: { name: string; category: string; weight: HabitWeight }) => void;\n    initialHabit?: Habit;\n    allHabits?: Habit[];\n    onDeleteFromLibrary?: (habitId: string) => void;\n    onRenameCategory?: (oldName: string, newName: string) => Promise<void>;\n    onDeleteCategory?: (categoryName: string) => Promise<void>;\n}\n\nexport const HabitFormModal: React.FC<HabitFormModalProps> = ({\n    isOpen, onClose, onSave, initialHabit, allHabits = [], onDeleteFromLibrary, onRenameCategory, onDeleteCategory\n}) => {\n    const [activeTab, setActiveTab] = useState<'create' | 'library'>('create');\n    const [isManagingCats, setIsManagingCats] = useState(false);\n\n    // Form State\n    const [name, setName] = useState('');\n    const [category, setCategory] = useState('');\n    const [weight, setWeight] = useState<HabitWeight>(HabitWeight.MEDIUM);\n\n    // Library State\n    const [librarySearch, setLibrarySearch] = useState('');\n    const [verifyDeleteId, setVerifyDeleteId] = useState<string | null>(null);\n\n    // Category Manager State\n    const [editingCatName, setEditingCatName] = useState<string | null>(null);\n    const [tempCatName, setTempCatName] = useState('');\n    const [verifyDeleteCat, setVerifyDeleteCat] = useState<string | null>(null);\n\n    useEffect(() => {\n        if (initialHabit) {\n            setName(initialHabit.name);\n            setCategory(initialHabit.category);\n            setWeight(initialHabit.weight);\n            setActiveTab('create');\n        } else {\n            // Reset only if opening for new habit\n            if (isOpen && !initialHabit && activeTab === 'create' && name === '') {\n                setName('');\n                setCategory('');\n                setWeight(HabitWeight.MEDIUM);\n            }\n        }\n        setIsManagingCats(false);\n    }, [initialHabit, isOpen]);\n\n    // Smart Category Derivation\n    const uniqueCategories = useMemo(() => {\n        const cats = new Set(allHabits.map(h => h.category).filter(Boolean));\n        return Array.from(cats).sort();\n    }, [allHabits]);\n\n    // Smart Library Derivation\n    const libraryItems = useMemo(() => {\n        const unique = new Map<string, Habit>();\n        allHabits.forEach(h => {\n            if (!unique.has(h.name)) {\n                unique.set(h.name, h);\n            }\n        });\n        return Array.from(unique.values()).filter(h =>\n            h.name.toLowerCase().includes(librarySearch.toLowerCase()) ||\n            h.category.toLowerCase().includes(librarySearch.toLowerCase())\n        );\n    }, [allHabits, librarySearch]);\n\n    if (!isOpen) return null;\n\n    const handleSave = () => {\n        if (!name.trim() || !category.trim()) return;\n        onSave({ name, category, weight });\n    };\n\n    const handleImportFromLibrary = (habit: Habit) => {\n        setName(habit.name);\n        setCategory(habit.category);\n        setWeight(habit.weight);\n        setActiveTab('create');\n    };\n\n    const handleDeleteClick = (e: React.MouseEvent, id: string) => {\n        e.stopPropagation();\n        if (verifyDeleteId === id) {\n            if (onDeleteFromLibrary) onDeleteFromLibrary(id);\n            setVerifyDeleteId(null);\n        } else {\n            setVerifyDeleteId(id);\n            setTimeout(() => setVerifyDeleteId(null), 3000);\n        }\n    };\n\n    // --- Category Manager Handlers ---\n    const startEditCategory = (cat: string) => {\n        setEditingCatName(cat);\n        setTempCatName(cat);\n    };\n\n    const saveEditCategory = async () => {\n        if (editingCatName && tempCatName.trim() && tempCatName !== editingCatName) {\n            if (onRenameCategory) {\n                await onRenameCategory(editingCatName, tempCatName.trim());\n                // If the current form category matched the edited one, update it too\n                if (category === editingCatName) setCategory(tempCatName.trim());\n            }\n        }\n        setEditingCatName(null);\n        setTempCatName('');\n    };\n\n    const deleteCategory = async (cat: string) => {\n        if (verifyDeleteCat === cat) {\n            if (onDeleteCategory) {\n                await onDeleteCategory(cat);\n                // If form selected this category, clear it\n                if (category === cat) setCategory('');\n            }\n            setVerifyDeleteCat(null);\n        } else {\n            setVerifyDeleteCat(cat);\n            setTimeout(() => setVerifyDeleteCat(null), 3000);\n        }\n    };\n\n    return (\n        <div className=\"fixed inset-0 z-[60] flex items-center justify-center bg-graphite-950/80 backdrop-blur-sm p-4\" onClick={onClose}>\n            <div className=\"w-full max-w-lg rounded-2xl bg-white dark:bg-graphite-900 shadow-2xl animate-in zoom-in-95 duration-200 border border-graphite-200 dark:border-graphite-800 flex flex-col max-h-[85vh]\" onClick={(e) => e.stopPropagation()}>\n\n                {/* Header & Tabs */}\n                <div className=\"flex-none border-b border-graphite-200 dark:border-graphite-800\">\n                    <div className=\"p-6 pb-4 flex justify-between items-center\">\n                        <h2 className=\"text-lg font-bold text-graphite-900 dark:text-white flex items-center gap-2\">\n                            {isManagingCats ? (\n                                <><Settings size={18} className=\"text-graphite-500\" /> Manage Categories</>\n                            ) : activeTab === 'create' ? (\n                                <><CheckCircle2 size={18} className=\"text-pacific-500\" /> {initialHabit ? 'Edit Habit' : 'Add Habit'}</>\n                            ) : (\n                                <><Library size={18} className=\"text-bali-500\" /> Habit Library</>\n                            )}\n                        </h2>\n                        <button onClick={onClose} className=\"text-graphite-400 hover:text-white\"><X size={18} /></button>\n                    </div>\n\n                    {!initialHabit && !isManagingCats && (\n                        <div className=\"px-6 flex gap-4\">\n                            <button\n                                onClick={() => setActiveTab('create')}\n                                className={`pb-3 text-xs font-bold uppercase tracking-wider transition-colors border-b-2 ${activeTab === 'create' ? 'border-pacific-500 text-pacific-600 dark:text-pacific-400' : 'border-transparent text-graphite-400 hover:text-graphite-600 dark:hover:text-graphite-300'}`}\n                            >\n                                Create New\n                            </button>\n                            <button\n                                onClick={() => setActiveTab('library')}\n                                className={`pb-3 text-xs font-bold uppercase tracking-wider transition-colors border-b-2 ${activeTab === 'library' ? 'border-bali-500 text-bali-600 dark:text-bali-400' : 'border-transparent text-graphite-400 hover:text-graphite-600 dark:hover:text-graphite-300'}`}\n                            >\n                                From History\n                            </button>\n                        </div>\n                    )}\n                </div>\n\n                {/* Content Area */}\n                <div className=\"flex-1 overflow-y-auto p-6\">\n                    {isManagingCats ? (\n                        <div className=\"animate-in fade-in slide-in-from-right-4 space-y-4\">\n                            <div className=\"flex items-center justify-between mb-2\">\n                                <button onClick={() => setIsManagingCats(false)} className=\"text-xs font-bold text-graphite-500 hover:text-pacific-500 flex items-center gap-1\">\n                                    <ArrowLeft size={12} /> Back to Form\n                                </button>\n                                <span className=\"text-[10px] uppercase text-graphite-400 font-bold\">{uniqueCategories.length} Categories</span>\n                            </div>\n\n                            <div className=\"space-y-2\">\n                                {uniqueCategories.map(cat => (\n                                    <div key={cat} className=\"group flex items-center justify-between p-3 rounded-xl border border-graphite-200 dark:border-graphite-800 bg-white dark:bg-graphite-800/50 hover:border-pacific-200 dark:hover:border-pacific-900 transition-all\">\n                                        {editingCatName === cat ? (\n                                            <div className=\"flex items-center gap-2 flex-1\">\n                                                <input\n                                                    value={tempCatName}\n                                                    onChange={e => setTempCatName(e.target.value)}\n                                                    className=\"flex-1 bg-graphite-50 dark:bg-graphite-900 border border-pacific-500 rounded-lg px-2 py-1 text-sm text-graphite-900 dark:text-white outline-none\"\n                                                    autoFocus\n                                                    onKeyDown={e => e.key === 'Enter' && saveEditCategory()}\n                                                />\n                                                <button onClick={saveEditCategory} className=\"p-1.5 bg-pacific-500 text-white rounded-lg\"><Check size={14} /></button>\n                                                <button onClick={() => setEditingCatName(null)} className=\"p-1.5 text-graphite-400 hover:text-white\"><X size={14} /></button>\n                                            </div>\n                                        ) : (\n                                            <>\n                                                <span className=\"text-sm font-medium text-graphite-700 dark:text-graphite-300\">{cat}</span>\n                                                <div className=\"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity\">\n                                                    <button onClick={() => startEditCategory(cat)} className=\"p-2 text-graphite-400 hover:text-pacific-500 hover:bg-pacific-50 dark:hover:bg-pacific-900/20 rounded-lg\"><Edit2 size={14} /></button>\n                                                    {cat !== 'Uncategorized' && (\n                                                        <button\n                                                            onClick={() => deleteCategory(cat)}\n                                                            className={`p-2 rounded-lg flex items-center gap-2 transition-all ${verifyDeleteCat === cat ? 'bg-red-500 text-white w-24 justify-center' : 'text-graphite-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20'}`}\n                                                        >\n                                                            <Trash2 size={14} /> {verifyDeleteCat === cat && <span className=\"text-[10px] font-bold\">Confirm</span>}\n                                                        </button>\n                                                    )}\n                                                </div>\n                                            </>\n                                        )}\n                                    </div>\n                                ))}\n                                {uniqueCategories.length === 0 && <div className=\"text-center py-8 text-graphite-400 text-sm\">No categories defined yet.</div>}\n                            </div>\n\n                            <div className=\"p-3 bg-blue-50 dark:bg-blue-900/10 rounded-xl border border-blue-100 dark:border-blue-900/30 flex gap-3 items-start\">\n                                <AlertCircle size={16} className=\"text-blue-500 mt-0.5 shrink-0\" />\n                                <div className=\"text-xs text-blue-700 dark:text-blue-300 leading-relaxed\">\n                                    <strong>Note:</strong> Renaming updates all habits history. Deleting moves associated habits to \"Uncategorized\".\n                                </div>\n                            </div>\n                        </div>\n                    ) : activeTab === 'create' ? (\n                        <div className=\"space-y-5 animate-in fade-in slide-in-from-left-4\">\n                            <div>\n                                <label className=\"block text-xs font-bold text-graphite-500 uppercase mb-1.5\">Habit Name</label>\n                                <input value={name} onChange={e => setName(e.target.value)} className=\"w-full bg-graphite-50 dark:bg-graphite-800 border border-graphite-200 dark:border-graphite-700 rounded-xl px-4 py-3 text-sm focus:outline-none focus:border-pacific-500 text-graphite-900 dark:text-white transition-all\" placeholder=\"e.g. Morning Run\" autoFocus />\n                            </div>\n\n                            <div>\n                                <div className=\"flex justify-between items-center mb-1.5\">\n                                    <label className=\"block text-xs font-bold text-graphite-500 uppercase\">Category</label>\n                                    <button onClick={() => setIsManagingCats(true)} className=\"text-[10px] font-bold text-pacific-500 hover:text-pacific-600 flex items-center gap-1\"><Settings size={10} /> Manage</button>\n                                </div>\n                                <div className=\"relative\">\n                                    <Tag size={14} className=\"absolute left-3 top-1/2 -translate-y-1/2 text-graphite-400\" />\n                                    <input value={category} onChange={e => setCategory(e.target.value)} className=\"w-full bg-graphite-50 dark:bg-graphite-800 border border-graphite-200 dark:border-graphite-700 rounded-xl pl-9 pr-4 py-3 text-sm focus:outline-none focus:border-pacific-500 text-graphite-900 dark:text-white transition-all\" placeholder=\"e.g. Health\" />\n                                </div>\n                                {/* Category Chips */}\n                                {uniqueCategories.length > 0 && (\n                                    <div className=\"mt-2 flex flex-wrap gap-2\">\n                                        {uniqueCategories.slice(0, 8).map(cat => (\n                                            <button\n                                                key={cat}\n                                                onClick={() => setCategory(cat === category ? '' : cat)}\n                                                className={`px-2.5 py-1 rounded-lg text-[10px] font-bold uppercase tracking-wide border transition-all ${category === cat ? 'bg-pacific-500 text-white border-pacific-500' : 'bg-graphite-100 dark:bg-graphite-800 text-graphite-500 border-transparent hover:bg-pacific-50 dark:hover:bg-pacific-900/20 hover:text-pacific-600 dark:hover:text-pacific-400'}`}\n                                            >\n                                                {cat}\n                                            </button>\n                                        ))}\n                                    </div>\n                                )}\n                            </div>\n\n                            <div>\n                                <label className=\"block text-xs font-bold text-graphite-500 uppercase mb-1.5\">Impact Weight</label>\n                                <div className=\"grid grid-cols-3 gap-2\">\n                                    {[HabitWeight.LOW, HabitWeight.MEDIUM, HabitWeight.HIGH].map((w) => (\n                                        <button\n                                            key={w}\n                                            onClick={() => setWeight(w)}\n                                            className={`py-2.5 text-xs font-bold rounded-xl border transition-all ${weight === w ? 'bg-pacific-500 text-white border-pacific-500 shadow-md shadow-pacific-500/20' : 'bg-graphite-50 dark:bg-graphite-800 text-graphite-500 border-graphite-200 dark:border-graphite-700 hover:border-graphite-400'}`}\n                                        >\n                                            {w === HabitWeight.LOW ? 'Low (1)' : w === HabitWeight.MEDIUM ? 'Medium (2)' : 'High (4)'}\n                                        </button>\n                                    ))}\n                                </div>\n                            </div>\n                        </div>\n                    ) : (\n                        <div className=\"flex flex-col h-full animate-in fade-in slide-in-from-right-4\">\n                            <div className=\"relative mb-4\">\n                                <Search size={14} className=\"absolute left-3 top-1/2 -translate-y-1/2 text-graphite-400\" />\n                                <input\n                                    value={librarySearch}\n                                    onChange={e => setLibrarySearch(e.target.value)}\n                                    className=\"w-full bg-graphite-50 dark:bg-graphite-800 border border-graphite-200 dark:border-graphite-700 rounded-xl pl-9 pr-4 py-2 text-sm focus:outline-none focus:border-bali-500 text-graphite-900 dark:text-white\"\n                                    placeholder=\"Search history...\"\n                                    autoFocus\n                                />\n                            </div>\n                            <div className=\"flex-1 overflow-y-auto space-y-2 pr-1\">\n                                {libraryItems.length > 0 ? libraryItems.map(habit => (\n                                    <div key={habit.id} onClick={() => handleImportFromLibrary(habit)} className=\"group flex items-center justify-between p-3 rounded-xl border border-graphite-200 dark:border-graphite-800 bg-white dark:bg-graphite-800/50 hover:border-bali-500 dark:hover:border-bali-500 cursor-pointer transition-all\">\n                                        <div>\n                                            <div className=\"text-sm font-bold text-graphite-900 dark:text-white group-hover:text-bali-600 dark:group-hover:text-bali-400 transition-colors\">{habit.name}</div>\n                                            <div className=\"flex items-center gap-2 mt-1\">\n                                                <span className=\"text-[10px] font-medium bg-graphite-100 dark:bg-graphite-900 text-graphite-500 px-2 py-0.5 rounded\">{habit.category}</span>\n                                                <div className=\"flex gap-0.5\">{[...Array(habit.weight)].map((_, i) => <div key={i} className=\"h-1 w-1 rounded-full bg-bali-400\" />)}</div>\n                                            </div>\n                                        </div>\n                                        <div className=\"flex items-center gap-2\">\n                                            <button\n                                                onClick={(e) => handleDeleteClick(e, habit.id)}\n                                                className={`p-2 rounded-lg transition-all ${verifyDeleteId === habit.id ? 'bg-red-500 text-white' : 'text-graphite-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 opacity-0 group-hover:opacity-100'}`}\n                                            >\n                                                <Trash2 size={14} />\n                                            </button>\n                                            <ArrowRight size={16} className=\"text-graphite-300 group-hover:text-bali-500 -translate-x-2 group-hover:translate-x-0 transition-all opacity-0 group-hover:opacity-100\" />\n                                        </div>\n                                    </div>\n                                )) : (\n                                    <div className=\"text-center py-12 text-graphite-400 text-sm\">No matching habits found in history.</div>\n                                )}\n                            </div>\n                        </div>\n                    )}\n                </div>\n\n                {/* Footer */}\n                <div className=\"p-6 border-t border-graphite-200 dark:border-graphite-800 flex justify-end gap-3 bg-white dark:bg-graphite-900 rounded-b-2xl\">\n                    {!isManagingCats ? (\n                        <>\n                            <button onClick={onClose} className=\"px-4 py-2 text-sm font-bold text-graphite-500 hover:text-graphite-800 dark:hover:text-white transition-colors\">Cancel</button>\n                            {activeTab === 'create' && (\n                                <button onClick={handleSave} disabled={!name.trim()} className=\"px-6 py-2 bg-pacific-600 text-white rounded-xl text-sm font-bold shadow-lg shadow-pacific-500/30 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-pacific-500 transition-colors flex items-center gap-2\">\n                                    <Save size={14} /> Save\n                                </button>\n                            )}\n                        </>\n                    ) : (\n                        <button onClick={() => setIsManagingCats(false)} className=\"px-6 py-2 bg-graphite-100 dark:bg-graphite-800 text-graphite-900 dark:text-white rounded-xl text-sm font-bold hover:bg-graphite-200 dark:hover:bg-graphite-700 transition-colors\">\n                            Done\n                        </button>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;AAaO,MAAM,iBAAgD,CAAC,EAC1D,MAAM,EAAE,OAAO,EAAE,MAAM,EAAE,YAAY,EAAE,YAAY,EAAE,EAAE,mBAAmB,EAAE,gBAAgB,EAAE,gBAAgB,EACjH;IACG,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAuB;IACjE,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,iNAAQ,EAAC;IAErD,aAAa;IACb,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAC;IACjC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC;IACzC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAc,oIAAW,CAAC,MAAM;IAEpE,gBAAgB;IAChB,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,iNAAQ,EAAC;IACnD,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,iNAAQ,EAAgB;IAEpE,yBAAyB;IACzB,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,iNAAQ,EAAgB;IACpE,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,iNAAQ,EAAC;IAC/C,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,iNAAQ,EAAgB;IAEtE,IAAA,kNAAS,EAAC;QACN,IAAI,cAAc;YACd,QAAQ,aAAa,IAAI;YACzB,YAAY,aAAa,QAAQ;YACjC,UAAU,aAAa,MAAM;YAC7B,aAAa;QACjB,OAAO;YACH,sCAAsC;YACtC,IAAI,UAAU,CAAC,gBAAgB,cAAc,YAAY,SAAS,IAAI;gBAClE,QAAQ;gBACR,YAAY;gBACZ,UAAU,oIAAW,CAAC,MAAM;YAChC;QACJ;QACA,kBAAkB;IACtB,GAAG;QAAC;QAAc;KAAO;IAEzB,4BAA4B;IAC5B,MAAM,mBAAmB,IAAA,gNAAO,EAAC;QAC7B,MAAM,OAAO,IAAI,IAAI,UAAU,GAAG,CAAC,CAAA,IAAK,EAAE,QAAQ,EAAE,MAAM,CAAC;QAC3D,OAAO,MAAM,IAAI,CAAC,MAAM,IAAI;IAChC,GAAG;QAAC;KAAU;IAEd,2BAA2B;IAC3B,MAAM,eAAe,IAAA,gNAAO,EAAC;QACzB,MAAM,SAAS,IAAI;QACnB,UAAU,OAAO,CAAC,CAAA;YACd,IAAI,CAAC,OAAO,GAAG,CAAC,EAAE,IAAI,GAAG;gBACrB,OAAO,GAAG,CAAC,EAAE,IAAI,EAAE;YACvB;QACJ;QACA,OAAO,MAAM,IAAI,CAAC,OAAO,MAAM,IAAI,MAAM,CAAC,CAAA,IACtC,EAAE,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC,cAAc,WAAW,OACvD,EAAE,QAAQ,CAAC,WAAW,GAAG,QAAQ,CAAC,cAAc,WAAW;IAEnE,GAAG;QAAC;QAAW;KAAc;IAE7B,IAAI,CAAC,QAAQ,OAAO;IAEpB,MAAM,aAAa;QACf,IAAI,CAAC,KAAK,IAAI,MAAM,CAAC,SAAS,IAAI,IAAI;QACtC,OAAO;YAAE;YAAM;YAAU;QAAO;IACpC;IAEA,MAAM,0BAA0B,CAAC;QAC7B,QAAQ,MAAM,IAAI;QAClB,YAAY,MAAM,QAAQ;QAC1B,UAAU,MAAM,MAAM;QACtB,aAAa;IACjB;IAEA,MAAM,oBAAoB,CAAC,GAAqB;QAC5C,EAAE,eAAe;QACjB,IAAI,mBAAmB,IAAI;YACvB,IAAI,qBAAqB,oBAAoB;YAC7C,kBAAkB;QACtB,OAAO;YACH,kBAAkB;YAClB,WAAW,IAAM,kBAAkB,OAAO;QAC9C;IACJ;IAEA,oCAAoC;IACpC,MAAM,oBAAoB,CAAC;QACvB,kBAAkB;QAClB,eAAe;IACnB;IAEA,MAAM,mBAAmB;QACrB,IAAI,kBAAkB,YAAY,IAAI,MAAM,gBAAgB,gBAAgB;YACxE,IAAI,kBAAkB;gBAClB,MAAM,iBAAiB,gBAAgB,YAAY,IAAI;gBACvD,qEAAqE;gBACrE,IAAI,aAAa,gBAAgB,YAAY,YAAY,IAAI;YACjE;QACJ;QACA,kBAAkB;QAClB,eAAe;IACnB;IAEA,MAAM,iBAAiB,OAAO;QAC1B,IAAI,oBAAoB,KAAK;YACzB,IAAI,kBAAkB;gBAClB,MAAM,iBAAiB;gBACvB,2CAA2C;gBAC3C,IAAI,aAAa,KAAK,YAAY;YACtC;YACA,mBAAmB;QACvB,OAAO;YACH,mBAAmB;YACnB,WAAW,IAAM,mBAAmB,OAAO;QAC/C;IACJ;IAEA,qBACI,8OAAC;QAAI,WAAU;QAAgG,SAAS;kBACpH,cAAA,8OAAC;YAAI,WAAU;YAAyL,SAAS,CAAC,IAAM,EAAE,eAAe;;8BAGrO,8OAAC;oBAAI,WAAU;;sCACX,8OAAC;4BAAI,WAAU;;8CACX,8OAAC;oCAAG,WAAU;8CACT,+BACG;;0DAAE,8OAAC,sNAAQ;gDAAC,MAAM;gDAAI,WAAU;;;;;;4CAAsB;;uDACtD,cAAc,yBACd;;0DAAE,8OAAC,0OAAY;gDAAC,MAAM;gDAAI,WAAU;;;;;;4CAAqB;4CAAE,eAAe,eAAe;;qEAEzF;;0DAAE,8OAAC,mNAAO;gDAAC,MAAM;gDAAI,WAAU;;;;;;4CAAkB;;;;;;;;8CAGzD,8OAAC;oCAAO,SAAS;oCAAS,WAAU;8CAAqC,cAAA,8OAAC,iMAAC;wCAAC,MAAM;;;;;;;;;;;;;;;;;wBAGrF,CAAC,gBAAgB,CAAC,gCACf,8OAAC;4BAAI,WAAU;;8CACX,8OAAC;oCACG,SAAS,IAAM,aAAa;oCAC5B,WAAW,CAAC,6EAA6E,EAAE,cAAc,WAAW,8DAA8D,6FAA6F;8CAClR;;;;;;8CAGD,8OAAC;oCACG,SAAS,IAAM,aAAa;oCAC5B,WAAW,CAAC,6EAA6E,EAAE,cAAc,YAAY,qDAAqD,6FAA6F;8CAC1Q;;;;;;;;;;;;;;;;;;8BAQb,8OAAC;oBAAI,WAAU;8BACV,+BACG,8OAAC;wBAAI,WAAU;;0CACX,8OAAC;gCAAI,WAAU;;kDACX,8OAAC;wCAAO,SAAS,IAAM,kBAAkB;wCAAQ,WAAU;;0DACvD,8OAAC,6NAAS;gDAAC,MAAM;;;;;;4CAAM;;;;;;;kDAE3B,8OAAC;wCAAK,WAAU;;4CAAqD,iBAAiB,MAAM;4CAAC;;;;;;;;;;;;;0CAGjG,8OAAC;gCAAI,WAAU;;oCACV,iBAAiB,GAAG,CAAC,CAAA,oBAClB,8OAAC;4CAAc,WAAU;sDACpB,mBAAmB,oBAChB,8OAAC;gDAAI,WAAU;;kEACX,8OAAC;wDACG,OAAO;wDACP,UAAU,CAAA,IAAK,eAAe,EAAE,MAAM,CAAC,KAAK;wDAC5C,WAAU;wDACV,SAAS;wDACT,WAAW,CAAA,IAAK,EAAE,GAAG,KAAK,WAAW;;;;;;kEAEzC,8OAAC;wDAAO,SAAS;wDAAkB,WAAU;kEAA6C,cAAA,8OAAC,6MAAK;4DAAC,MAAM;;;;;;;;;;;kEACvG,8OAAC;wDAAO,SAAS,IAAM,kBAAkB;wDAAO,WAAU;kEAA2C,cAAA,8OAAC,iMAAC;4DAAC,MAAM;;;;;;;;;;;;;;;;yGAGlH;;kEACI,8OAAC;wDAAK,WAAU;kEAAgE;;;;;;kEAChF,8OAAC;wDAAI,WAAU;;0EACX,8OAAC;gEAAO,SAAS,IAAM,kBAAkB;gEAAM,WAAU;0EAA2G,cAAA,8OAAC,2MAAK;oEAAC,MAAM;;;;;;;;;;;4DAChL,QAAQ,iCACL,8OAAC;gEACG,SAAS,IAAM,eAAe;gEAC9B,WAAW,CAAC,sDAAsD,EAAE,oBAAoB,MAAM,8CAA8C,iFAAiF;;kFAE7N,8OAAC,oNAAM;wEAAC,MAAM;;;;;;oEAAM;oEAAE,oBAAoB,qBAAO,8OAAC;wEAAK,WAAU;kFAAwB;;;;;;;;;;;;;;;;;;;;2CAvBvG;;;;;oCA+Bb,iBAAiB,MAAM,KAAK,mBAAK,8OAAC;wCAAI,WAAU;kDAA6C;;;;;;;;;;;;0CAGlG,8OAAC;gCAAI,WAAU;;kDACX,8OAAC,mOAAW;wCAAC,MAAM;wCAAI,WAAU;;;;;;kDACjC,8OAAC;wCAAI,WAAU;;0DACX,8OAAC;0DAAO;;;;;;4CAAc;;;;;;;;;;;;;;;;;;mEAIlC,cAAc,yBACd,8OAAC;wBAAI,WAAU;;0CACX,8OAAC;;kDACG,8OAAC;wCAAM,WAAU;kDAA6D;;;;;;kDAC9E,8OAAC;wCAAM,OAAO;wCAAM,UAAU,CAAA,IAAK,QAAQ,EAAE,MAAM,CAAC,KAAK;wCAAG,WAAU;wCAA2N,aAAY;wCAAmB,SAAS;;;;;;;;;;;;0CAG7U,8OAAC;;kDACG,8OAAC;wCAAI,WAAU;;0DACX,8OAAC;gDAAM,WAAU;0DAAsD;;;;;;0DACvE,8OAAC;gDAAO,SAAS,IAAM,kBAAkB;gDAAO,WAAU;;kEAAwF,8OAAC,sNAAQ;wDAAC,MAAM;;;;;;oDAAM;;;;;;;;;;;;;kDAE5K,8OAAC;wCAAI,WAAU;;0DACX,8OAAC,uMAAG;gDAAC,MAAM;gDAAI,WAAU;;;;;;0DACzB,8OAAC;gDAAM,OAAO;gDAAU,UAAU,CAAA,IAAK,YAAY,EAAE,MAAM,CAAC,KAAK;gDAAG,WAAU;gDAAgO,aAAY;;;;;;;;;;;;oCAG7T,iBAAiB,MAAM,GAAG,mBACvB,8OAAC;wCAAI,WAAU;kDACV,iBAAiB,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC,CAAA,oBAC9B,8OAAC;gDAEG,SAAS,IAAM,YAAY,QAAQ,WAAW,KAAK;gDACnD,WAAW,CAAC,2FAA2F,EAAE,aAAa,MAAM,iDAAiD,iLAAiL;0DAE7V;+CAJI;;;;;;;;;;;;;;;;0CAWzB,8OAAC;;kDACG,8OAAC;wCAAM,WAAU;kDAA6D;;;;;;kDAC9E,8OAAC;wCAAI,WAAU;kDACV;4CAAC,oIAAW,CAAC,GAAG;4CAAE,oIAAW,CAAC,MAAM;4CAAE,oIAAW,CAAC,IAAI;yCAAC,CAAC,GAAG,CAAC,CAAC,kBAC1D,8OAAC;gDAEG,SAAS,IAAM,UAAU;gDACzB,WAAW,CAAC,0DAA0D,EAAE,WAAW,IAAI,iFAAiF,gIAAgI;0DAEvS,MAAM,oIAAW,CAAC,GAAG,GAAG,YAAY,MAAM,oIAAW,CAAC,MAAM,GAAG,eAAe;+CAJ1E;;;;;;;;;;;;;;;;;;;;;iFAWzB,8OAAC;wBAAI,WAAU;;0CACX,8OAAC;gCAAI,WAAU;;kDACX,8OAAC,gNAAM;wCAAC,MAAM;wCAAI,WAAU;;;;;;kDAC5B,8OAAC;wCACG,OAAO;wCACP,UAAU,CAAA,IAAK,iBAAiB,EAAE,MAAM,CAAC,KAAK;wCAC9C,WAAU;wCACV,aAAY;wCACZ,SAAS;;;;;;;;;;;;0CAGjB,8OAAC;gCAAI,WAAU;0CACV,aAAa,MAAM,GAAG,IAAI,aAAa,GAAG,CAAC,CAAA,sBACxC,8OAAC;wCAAmB,SAAS,IAAM,wBAAwB;wCAAQ,WAAU;;0DACzE,8OAAC;;kEACG,8OAAC;wDAAI,WAAU;kEAAkI,MAAM,IAAI;;;;;;kEAC3J,8OAAC;wDAAI,WAAU;;0EACX,8OAAC;gEAAK,WAAU;0EAAsG,MAAM,QAAQ;;;;;;0EACpI,8OAAC;gEAAI,WAAU;0EAAgB;uEAAI,MAAM,MAAM,MAAM;iEAAE,CAAC,GAAG,CAAC,CAAC,GAAG,kBAAM,8OAAC;wEAAY,WAAU;uEAAb;;;;;;;;;;;;;;;;;;;;;;0DAGxF,8OAAC;gDAAI,WAAU;;kEACX,8OAAC;wDACG,SAAS,CAAC,IAAM,kBAAkB,GAAG,MAAM,EAAE;wDAC7C,WAAW,CAAC,8BAA8B,EAAE,mBAAmB,MAAM,EAAE,GAAG,0BAA0B,mHAAmH;kEAEvN,cAAA,8OAAC,oNAAM;4DAAC,MAAM;;;;;;;;;;;kEAElB,8OAAC,gOAAU;wDAAC,MAAM;wDAAI,WAAU;;;;;;;;;;;;;uCAf9B,MAAM,EAAE;;;;kGAmBlB,8OAAC;oCAAI,WAAU;8CAA8C;;;;;;;;;;;;;;;;;;;;;;8BAQjF,8OAAC;oBAAI,WAAU;8BACV,CAAC,+BACE;;0CACI,8OAAC;gCAAO,SAAS;gCAAS,WAAU;0CAAgH;;;;;;4BACnJ,cAAc,0BACX,8OAAC;gCAAO,SAAS;gCAAY,UAAU,CAAC,KAAK,IAAI;gCAAI,WAAU;;kDAC3D,8OAAC,0MAAI;wCAAC,MAAM;;;;;;oCAAM;;;;;;;;qDAK9B,8OAAC;wBAAO,SAAS,IAAM,kBAAkB;wBAAQ,WAAU;kCAAmL;;;;;;;;;;;;;;;;;;;;;;AAQtQ"}},
    {"offset": {"line": 1321, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/20252128/dev/Projects/el-portal/src/components/CycleEditorModal.tsx"],"sourcesContent":["\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Cycle, Goal, Habit, GoalType, EntityStatus, CCHItem } from '@/types/types';\r\nimport { supabaseService } from '@/lib/supabaseService';\r\nimport { Edit3, Brain, Fingerprint, Activity, Plus, Trash2, CheckCircle2, List, X, Save, Target, AlertTriangle, Calendar, Rocket, Power, AlertCircle } from 'lucide-react';\r\nimport { GoalFormModal } from './GoalFormModal';\r\nimport { HabitFormModal } from './HabitFormModal';\r\n\r\ninterface CycleEditorModalProps {\r\n    mode?: 'create' | 'edit';\r\n    cycle?: Cycle; // Optional, undefined in 'create' mode\r\n    goals: Goal[];\r\n    habits: Habit[];\r\n    allHabits: Habit[];\r\n    suggestedSprintNumber?: number; // For create mode auto-fill\r\n    onClose: () => void;\r\n    // Handler for 'edit' mode (atomic updates)\r\n    onSaveCycle?: (cycle: Cycle) => void;\r\n    onManageGoal?: (action: 'create' | 'update' | 'delete', goal: any) => void;\r\n    onManageHabit?: (action: 'create' | 'update' | 'delete', habit: any) => void;\r\n    // Handler for 'create' mode (bulk save)\r\n    onCreate?: (cycleData: any, goals: any[], habits: any[]) => void;\r\n    // Category Handlers\r\n    onRenameCategory?: (oldName: string, newName: string) => Promise<void>;\r\n    onDeleteCategory?: (categoryName: string) => Promise<void>;\r\n    // Explicit Handler for deleting habits from the library (database)\r\n    onDeleteHabitFromDB?: (habitId: string) => Promise<void>;\r\n    // Dynamic Cycle Limit\r\n    maxCycles?: number;\r\n    // Context for Smart Scheduling\r\n    versionStartDate?: string;\r\n    existingCycles?: Cycle[];\r\n}\r\n\r\n// Helper for safe date arithmetic without timezone issues\r\nconst addDaysToDate = (dateStr: string, days: number): string => {\r\n    if (!dateStr) return '';\r\n    const parts = dateStr.split('-').map(Number);\r\n    // Create date in local time (Year, Month Index, Day)\r\n    const date = new Date(parts[0], parts[1] - 1, parts[2]);\r\n    date.setDate(date.getDate() + days);\r\n\r\n    const year = date.getFullYear();\r\n    const month = String(date.getMonth() + 1).padStart(2, '0');\r\n    const day = String(date.getDate()).padStart(2, '0');\r\n    return `${year}-${month}-${day}`;\r\n};\r\n\r\nexport const CycleEditorModal: React.FC<CycleEditorModalProps> = ({\r\n    mode = 'edit', cycle, goals, habits, allHabits, suggestedSprintNumber, onClose, onSaveCycle, onManageGoal, onManageHabit, onCreate, onRenameCategory, onDeleteCategory, onDeleteHabitFromDB, maxCycles = 6, versionStartDate, existingCycles\r\n}) => {\r\n    const [activeTab, setActiveTab] = useState<'strategy' | 'identity' | 'mantras' | 'goals' | 'habits'>('strategy');\r\n\r\n    // --- Cycle Config State (Create Mode) ---\r\n    const [sprintNumber, setSprintNumber] = useState(suggestedSprintNumber || 1);\r\n    const [startDate, setStartDate] = useState(new Date().toISOString().split('T')[0]);\r\n    const [endDate, setEndDate] = useState(new Date(Date.now() + 14 * 24 * 60 * 60 * 1000).toISOString().split('T')[0]);\r\n    const [isActive, setIsActive] = useState(true);\r\n    const [cycleDuration, setCycleDuration] = useState(15); // Default, updated by DB\r\n\r\n    // --- Cycle Content State ---\r\n    const [priorities, setPriorities] = useState<string[]>(['', '', '']);\r\n    const [problems, setProblems] = useState('');\r\n    const [learning, setLearning] = useState('');\r\n    const [beliefs, setBeliefs] = useState<string[]>([]);\r\n    const [characteristics, setCharacteristics] = useState<string[]>([]);\r\n    const [skills, setSkills] = useState<string[]>([]);\r\n    const [selectedMantras, setSelectedMantras] = useState<string[]>([]);\r\n\r\n    // --- Local Lists State (Buffer for Create Mode) ---\r\n    // In 'create' mode, we manipulate these arrays. In 'edit' mode, we use the props `goals` and `habits` but might optimistic update these for UI.\r\n    const [localGoals, setLocalGoals] = useState<Goal[]>([]);\r\n    const [localHabits, setLocalHabits] = useState<Habit[]>([]);\r\n\r\n    // --- Helper State ---\r\n    const [allMantras, setAllMantras] = useState<string[]>([]);\r\n    const [tempBelief, setTempBelief] = useState('');\r\n    const [tempChar, setTempChar] = useState('');\r\n    const [tempSkill, setTempSkill] = useState('');\r\n    const [newMantra, setNewMantra] = useState('');\r\n    const [error, setError] = useState<string | null>(null);\r\n\r\n    // --- Sub-Modals State ---\r\n    const [editingGoal, setEditingGoal] = useState<Goal | undefined>(undefined);\r\n    const [isGoalModalOpen, setIsGoalModalOpen] = useState(false);\r\n    const [editingHabit, setEditingHabit] = useState<Habit | undefined>(undefined);\r\n    const [isHabitModalOpen, setIsHabitModalOpen] = useState(false);\r\n    const [verifyDeleteId, setVerifyDeleteId] = useState<string | null>(null);\r\n\r\n    // Initialization\r\n    useEffect(() => {\r\n        supabaseService.getMantras().then(setAllMantras);\r\n\r\n        if (mode === 'edit' && cycle) {\r\n            setPriorities(cycle.focus_priorities);\r\n            setProblems(cycle.problems);\r\n            setLearning(cycle.learning_focus);\r\n            setBeliefs(cycle.cch_list.find(c => c.category === 'Beliefs')?.items || []);\r\n            setCharacteristics(cycle.cch_list.find(c => c.category === 'Characteristics')?.items || []);\r\n            setSkills(cycle.cch_list.find(c => c.category === 'Skills')?.items || []);\r\n            setSelectedMantras(cycle.mantras);\r\n            setSprintNumber(cycle.sprint_number);\r\n            setStartDate(cycle.start_date);\r\n            setEndDate(cycle.end_date);\r\n        }\r\n    }, [mode, cycle]);\r\n\r\n    // Smart Scheduling Logic\r\n    useEffect(() => {\r\n        const initScheduling = async () => {\r\n            // 1. Fetch System Settings\r\n            const settings = await supabaseService.getSystemSettings();\r\n            const duration = Math.floor(settings.days / settings.cycles);\r\n            setCycleDuration(duration);\r\n\r\n            // 2. Auto-Suggest Dates (Only in Create Mode)\r\n            if (mode === 'create' && versionStartDate) {\r\n                let suggestedStart = versionStartDate;\r\n\r\n                // If cycles exist, start after the last one\r\n                if (existingCycles && existingCycles.length > 0) {\r\n                    // Sort by end date descending\r\n                    const sorted = [...existingCycles].sort((a, b) => new Date(b.end_date).getTime() - new Date(a.end_date).getTime());\r\n                    const lastCycle = sorted[0];\r\n                    suggestedStart = addDaysToDate(lastCycle.end_date, 1);\r\n                }\r\n\r\n                setStartDate(suggestedStart);\r\n                setEndDate(addDaysToDate(suggestedStart, duration - 1));\r\n            }\r\n        };\r\n        initScheduling();\r\n    }, [mode, versionStartDate, existingCycles]);\r\n\r\n    // Sync local state with props in Edit mode\r\n    useEffect(() => {\r\n        if (mode === 'edit') {\r\n            setLocalGoals(goals);\r\n            setLocalHabits(habits);\r\n        }\r\n    }, [goals, habits, mode]);\r\n\r\n    // -- Cycle Logic Handlers --\r\n    const handleAddMantra = async () => { if (newMantra.trim()) { await supabaseService.addMantra(newMantra); setAllMantras(prev => [...prev, newMantra]); setSelectedMantras(prev => [...prev, newMantra]); setNewMantra(''); } };\r\n    const handleAddBelief = () => { if (tempBelief.trim()) { setBeliefs([...beliefs, tempBelief.trim()]); setTempBelief(''); } };\r\n    const handleAddChar = () => { if (tempChar.trim()) { setCharacteristics([...characteristics, tempChar.trim()]); setTempChar(''); } };\r\n    const handleAddSkill = () => { if (tempSkill.trim()) { setSkills([...skills, tempSkill.trim()]); setTempSkill(''); } };\r\n\r\n    const handleManualStartDateChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const newStart = e.target.value;\r\n        setStartDate(newStart);\r\n        if (newStart && cycleDuration > 0) {\r\n            setEndDate(addDaysToDate(newStart, cycleDuration - 1));\r\n        }\r\n    };\r\n\r\n    // -- Main Save Handler --\r\n    const handleFinalSave = () => {\r\n        // Validate Constraints\r\n        if (mode === 'create' && (sprintNumber < 1 || sprintNumber > maxCycles)) {\r\n            setError(`Versions are limited to exactly ${maxCycles} cycles.`);\r\n            setActiveTab('strategy');\r\n            return;\r\n        }\r\n\r\n        const cycleData = {\r\n            sprint_number: sprintNumber,\r\n            start_date: startDate,\r\n            end_date: endDate,\r\n            status: isActive ? EntityStatus.ACTIVE : undefined, // Only relevant for create usually\r\n            focus_priorities: priorities.filter(p => p.trim().length > 0),\r\n            problems,\r\n            learning_focus: learning,\r\n            mantras: selectedMantras,\r\n            cch_list: [\r\n                { category: 'Beliefs', items: beliefs },\r\n                { category: 'Characteristics', items: characteristics },\r\n                { category: 'Skills', items: skills }\r\n            ] as CCHItem[]\r\n        };\r\n\r\n        if (mode === 'create' && onCreate) {\r\n            onCreate(cycleData, localGoals, localHabits);\r\n        } else if (mode === 'edit' && onSaveCycle && cycle) {\r\n            // In edit mode, goals/habits are handled atomically by other handlers. We just save the cycle config.\r\n            onSaveCycle({ ...cycle, ...cycleData });\r\n        }\r\n    };\r\n\r\n    // -- Goal/Habit Wrapper Handlers --\r\n\r\n    const handleGoalSaveWrapper = (goalData: any, selectedHabit: any) => {\r\n        // goalData from modal: { title, description, type, subtasks (string[]) }\r\n        const newGoalObj = {\r\n            id: editingGoal?.id || `temp-g-${Date.now()}`,\r\n            ...goalData,\r\n            // If it's consistency, we need to store the habit data structure temporarily for the parent to process\r\n            linkedHabit: selectedHabit,\r\n            // In create mode, subtasks come as strings from modal, we format them for preview\r\n            subtasks: goalData.subtasks?.map((s: string) => ({ name: s, done: false }))\r\n        };\r\n\r\n        if (mode === 'create') {\r\n            if (editingGoal) {\r\n                setLocalGoals(prev => prev.map(g => g.id === editingGoal.id ? { ...g, ...newGoalObj } : g));\r\n            } else {\r\n                setLocalGoals(prev => [...prev, newGoalObj]);\r\n            }\r\n        } else {\r\n            // Edit Mode: Immediate DB Action\r\n            if (onManageGoal) {\r\n                const action = editingGoal ? 'update' : 'create';\r\n                onManageGoal(action, { ...newGoalObj, linkedHabit: selectedHabit });\r\n            }\r\n        }\r\n        setIsGoalModalOpen(false);\r\n    };\r\n\r\n    const handleHabitSaveWrapper = (habitData: any) => {\r\n        const newHabitObj = {\r\n            id: editingHabit?.id || `temp-h-${Date.now()}`,\r\n            ...habitData\r\n        };\r\n\r\n        if (mode === 'create') {\r\n            if (editingHabit) {\r\n                setLocalHabits(prev => prev.map(h => h.id === editingHabit.id ? newHabitObj : h));\r\n            } else {\r\n                setLocalHabits(prev => [...prev, newHabitObj]);\r\n            }\r\n        } else {\r\n            if (onManageHabit) {\r\n                const action = editingHabit ? 'update' : 'create';\r\n                onManageHabit(action, newHabitObj);\r\n            }\r\n        }\r\n        setIsHabitModalOpen(false);\r\n    };\r\n\r\n    // Handle deleting a habit from the library/history view in the modal\r\n    const handleDeleteFromLibrary = async (habitId: string) => {\r\n        if (onDeleteHabitFromDB) {\r\n            await onDeleteHabitFromDB(habitId);\r\n        } else if (onManageHabit) {\r\n            onManageHabit('delete', { id: habitId });\r\n        } else {\r\n            console.warn(\"Delete from library not fully supported in create mode without parent handler\");\r\n        }\r\n    };\r\n\r\n    const handleDeleteItem = (id: string, type: 'goal' | 'habit') => {\r\n        if (verifyDeleteId !== id) {\r\n            setVerifyDeleteId(id);\r\n            setTimeout(() => setVerifyDeleteId(null), 3000);\r\n            return;\r\n        }\r\n\r\n        if (mode === 'create') {\r\n            if (type === 'goal') setLocalGoals(prev => prev.filter(g => g.id !== id));\r\n            else setLocalHabits(prev => prev.filter(h => h.id !== id));\r\n        } else {\r\n            if (type === 'goal' && onManageGoal) onManageGoal('delete', { id });\r\n            if (type === 'habit' && onManageHabit) onManageHabit('delete', { id });\r\n        }\r\n        setVerifyDeleteId(null);\r\n    };\r\n\r\n    // Open Handlers\r\n    const openAddGoal = () => { setEditingGoal(undefined); setIsGoalModalOpen(true); };\r\n    const openEditGoal = (g: Goal) => { setEditingGoal(g); setIsGoalModalOpen(true); };\r\n    const openAddHabit = () => { setEditingHabit(undefined); setIsHabitModalOpen(true); };\r\n    const openEditHabit = (h: Habit) => { setEditingHabit(h); setIsHabitModalOpen(true); };\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-graphite-950/80 backdrop-blur-sm p-4\" onClick={onClose}>\r\n            <div className=\"w-full max-w-4xl rounded-2xl bg-white dark:bg-graphite-900 shadow-2xl animate-in zoom-in-95 duration-200 border border-graphite-200 dark:border-graphite-800 flex flex-col h-[85vh]\" onClick={e => e.stopPropagation()}>\r\n\r\n                {/* Header */}\r\n                <div className=\"p-6 border-b border-graphite-200 dark:border-graphite-800 flex justify-between items-center bg-graphite-50 dark:bg-graphite-950/50 rounded-t-2xl\">\r\n                    <div>\r\n                        <h2 className=\"text-xl font-bold text-graphite-900 dark:text-white flex items-center gap-2\">\r\n                            {mode === 'create' ? <Rocket size={20} className=\"text-pacific-500\" /> : <Edit3 size={20} className=\"text-pacific-500\" />}\r\n                            {mode === 'create' ? 'Initialize New Cycle' : 'Cycle Editor'}\r\n                        </h2>\r\n                        <div className=\"text-xs text-graphite-500 mt-1 uppercase tracking-wider\">\r\n                            {mode === 'create' ? 'System Configuration' : `Cycle ${cycle?.sprint_number} Configuration`}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Tabs */}\r\n                    <div className=\"flex bg-white dark:bg-graphite-800 p-1 rounded-xl border border-graphite-200 dark:border-graphite-700\">\r\n                        {[\r\n                            { id: 'strategy', icon: <Target size={14} /> },\r\n                            { id: 'identity', icon: <Fingerprint size={14} /> },\r\n                            { id: 'mantras', icon: <Brain size={14} /> },\r\n                            { id: 'goals', icon: <CheckCircle2 size={14} /> },\r\n                            { id: 'habits', icon: <List size={14} /> }\r\n                        ].map(tab => (\r\n                            <button\r\n                                key={tab.id}\r\n                                onClick={() => setActiveTab(tab.id as any)}\r\n                                className={`flex items-center gap-2 px-4 py-2 rounded-lg text-xs font-bold uppercase transition-all ${activeTab === tab.id\r\n                                    ? 'bg-pacific-500 text-white shadow-md'\r\n                                    : 'text-graphite-500 hover:text-graphite-900 dark:hover:text-graphite-white hover:bg-graphite-50 dark:hover:bg-graphite-700'\r\n                                    }`}\r\n                            >\r\n                                {tab.icon} {tab.id}\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n\r\n                    <button onClick={onClose} type=\"button\" className=\"text-graphite-400 hover:text-white transition-colors\"><X size={24} /></button>\r\n                </div>\r\n\r\n                <div className=\"flex-1 overflow-y-auto p-8 bg-graphite-50/50 dark:bg-graphite-900/50\">\r\n                    {/* STRATEGY TAB */}\r\n                    {activeTab === 'strategy' && (\r\n                        <div className=\"space-y-6 max-w-2xl mx-auto animate-in fade-in slide-in-from-right-2\">\r\n\r\n                            {/* CREATE MODE: Configuration Fields */}\r\n                            {mode === 'create' && (\r\n                                <div className=\"bg-white dark:bg-graphite-900 p-6 rounded-2xl border border-graphite-200 dark:border-graphite-800 shadow-sm space-y-4\">\r\n                                    <div className=\"flex items-center justify-between\">\r\n                                        <div className=\"flex items-center gap-2 text-pacific-500 text-xs font-bold uppercase tracking-widest\">\r\n                                            <Calendar size={14} /> Temporal Config\r\n                                        </div>\r\n                                        <div className=\"text-[10px] font-bold text-pacific-600 dark:text-pacific-400 bg-pacific-50 dark:bg-pacific-900/20 px-2 py-1 rounded\">\r\n                                            AUTO-SUGGESTED\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"grid grid-cols-2 gap-4\">\r\n                                        <div>\r\n                                            <label className=\"block text-xs font-bold text-graphite-500 uppercase mb-1.5\">Start Date</label>\r\n                                            <input\r\n                                                type=\"date\"\r\n                                                value={startDate}\r\n                                                onChange={handleManualStartDateChange}\r\n                                                className=\"w-full bg-graphite-50 dark:bg-graphite-950 border border-graphite-200 dark:border-graphite-700 rounded-xl px-3 py-2.5 text-sm text-graphite-900 dark:text-white focus:outline-none focus:border-pacific-500\"\r\n                                            />\r\n                                        </div>\r\n                                        <div>\r\n                                            <label className=\"block text-xs font-bold text-graphite-500 uppercase mb-1.5\">End Date</label>\r\n                                            <input\r\n                                                type=\"date\"\r\n                                                value={endDate}\r\n                                                onChange={e => setEndDate(e.target.value)}\r\n                                                className=\"w-full bg-graphite-50 dark:bg-graphite-950 border border-graphite-200 dark:border-graphite-700 rounded-xl px-3 py-2.5 text-sm text-graphite-900 dark:text-white focus:outline-none focus:border-pacific-500\"\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"grid grid-cols-2 gap-4 pt-2\">\r\n                                        <div>\r\n                                            <label className=\"block text-xs font-bold text-graphite-500 uppercase mb-1.5\">Cycle Number (1-{maxCycles})</label>\r\n                                            <input\r\n                                                type=\"number\"\r\n                                                min=\"1\"\r\n                                                max={maxCycles}\r\n                                                value={sprintNumber}\r\n                                                onChange={e => {\r\n                                                    const val = Number(e.target.value);\r\n                                                    setSprintNumber(val);\r\n                                                    if (val > maxCycles) setError(`Maximum ${maxCycles} cycles allowed per version.`);\r\n                                                    else setError(null);\r\n                                                }}\r\n                                                className={`w-full bg-graphite-50 dark:bg-graphite-950 border rounded-xl px-3 py-2.5 text-sm text-graphite-900 dark:text-white focus:outline-none focus:border-pacific-500 ${error ? 'border-red-500 ring-1 ring-red-500/20' : 'border-graphite-200 dark:border-graphite-700'}`}\r\n                                            />\r\n                                            {error && <p className=\"text-red-500 text-[10px] mt-1 font-bold flex items-center gap-1\"><AlertCircle size={10} /> {error}</p>}\r\n                                        </div>\r\n                                        <div className=\"flex items-end\">\r\n                                            <button\r\n                                                onClick={() => setIsActive(!isActive)}\r\n                                                className={`w-full py-2.5 rounded-xl border flex items-center justify-center gap-2 text-sm font-bold transition-all ${isActive ? 'bg-pacific-500/10 border-pacific-500/50 text-pacific-600 dark:text-pacific-400' : 'bg-graphite-50 dark:bg-graphite-950 border-graphite-200 dark:border-graphite-700 text-graphite-500'}`}\r\n                                            >\r\n                                                <Power size={16} /> {isActive ? 'Status: Active' : 'Status: Inactive'}\r\n                                            </button>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n\r\n                            <div className=\"bg-white dark:bg-graphite-900 p-6 rounded-2xl border border-graphite-200 dark:border-graphite-800 shadow-sm\">\r\n                                <label className=\"block text-xs font-bold text-graphite-500 uppercase mb-4\">Focus Priorities</label>\r\n                                <div className=\"space-y-3\">\r\n                                    {priorities.map((p, i) => (\r\n                                        <div key={i} className=\"flex gap-3\">\r\n                                            <span className=\"flex h-10 w-10 items-center justify-center rounded-lg bg-graphite-100 dark:bg-graphite-800 font-bold text-graphite-500 border border-graphite-200 dark:border-graphite-700\">{i + 1}</span>\r\n                                            <input value={p} onChange={e => { const newP = [...priorities]; newP[i] = e.target.value; setPriorities(newP); }} className=\"flex-1 bg-graphite-50 dark:bg-graphite-950 border border-graphite-200 dark:border-graphite-700 rounded-xl px-4 text-sm focus:outline-none focus:border-pacific-500 transition-colors\" placeholder={`Priority ${i + 1}`} />\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"bg-white dark:bg-graphite-900 p-6 rounded-2xl border border-graphite-200 dark:border-graphite-800 shadow-sm\">\r\n                                <label className=\"block text-xs font-bold text-graphite-500 uppercase mb-2\">Current Friction/Problems</label>\r\n                                <textarea value={problems} onChange={e => setProblems(e.target.value)} rows={3} className=\"w-full bg-graphite-50 dark:bg-graphite-950 border border-graphite-200 dark:border-graphite-700 rounded-xl p-4 text-sm focus:outline-none focus:border-pacific-500 resize-none transition-colors\" placeholder=\"What is slowing you down?\" />\r\n                            </div>\r\n                            <div className=\"bg-white dark:bg-graphite-900 p-6 rounded-2xl border border-graphite-200 dark:border-graphite-800 shadow-sm\">\r\n                                <label className=\"block text-xs font-bold text-graphite-500 uppercase mb-2\">Learning Focus</label>\r\n                                <input value={learning} onChange={e => setLearning(e.target.value)} className=\"w-full bg-graphite-50 dark:bg-graphite-950 border border-graphite-200 dark:border-graphite-700 rounded-xl p-4 text-sm focus:outline-none focus:border-pacific-500 transition-colors\" placeholder=\"One major skill to master...\" />\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* IDENTITY TAB */}\r\n                    {activeTab === 'identity' && (\r\n                        <div className=\"space-y-8 max-w-2xl mx-auto animate-in fade-in slide-in-from-right-2\">\r\n                            {[{ title: 'Core Beliefs', items: beliefs, add: handleAddBelief, val: tempBelief, set: setTempBelief, icon: <Brain size={18} /> }, { title: 'Characteristics', items: characteristics, add: handleAddChar, val: tempChar, set: setTempChar, icon: <Fingerprint size={18} /> }, { title: 'Skills Acquisition', items: skills, add: handleAddSkill, val: tempSkill, set: setTempSkill, icon: <Activity size={18} /> }].map((section, idx) => (\r\n                                <div key={idx} className=\"bg-white dark:bg-graphite-900 p-6 rounded-2xl border border-graphite-200 dark:border-graphite-800 shadow-sm\">\r\n                                    <h3 className=\"text-sm font-bold text-graphite-900 dark:text-white flex items-center gap-2 mb-4\">{section.icon} {section.title}</h3>\r\n                                    <div className=\"flex flex-wrap gap-2 mb-4\">\r\n                                        {section.items.map((item, i) => (\r\n                                            <span key={i} className=\"bg-graphite-100 dark:bg-graphite-800 px-3 py-1.5 rounded-lg text-xs font-medium flex items-center gap-2 border border-graphite-200 dark:border-graphite-700\">\r\n                                                {item}\r\n                                                <button onClick={() => { if (section.title === 'Core Beliefs') setBeliefs(beliefs.filter((_, j) => j !== i)); else if (section.title === 'Characteristics') setCharacteristics(characteristics.filter((_, j) => j !== i)); else setSkills(skills.filter((_, j) => j !== i)); }} className=\"text-graphite-400 hover:text-red-500\"><X size={12} /></button>\r\n                                            </span>\r\n                                        ))}\r\n                                    </div>\r\n                                    <div className=\"flex gap-2\">\r\n                                        <input value={section.val} onChange={e => section.set(e.target.value)} onKeyDown={e => e.key === 'Enter' && section.add()} className=\"flex-1 bg-graphite-50 dark:bg-graphite-950 border border-graphite-200 dark:border-graphite-700 rounded-xl px-4 py-2 text-sm focus:outline-none focus:border-pacific-500 transition-colors\" placeholder={`Add ${section.title}...`} />\r\n                                        <button onClick={section.add} className=\"p-2 bg-pacific-500 text-white rounded-xl hover:bg-pacific-600 transition-colors\"><Plus size={20} /></button>\r\n                                    </div>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* MANTRAS TAB */}\r\n                    {activeTab === 'mantras' && (\r\n                        <div className=\"space-y-4 max-w-2xl mx-auto animate-in fade-in slide-in-from-right-2 bg-white dark:bg-graphite-900 p-6 rounded-2xl border border-graphite-200 dark:border-graphite-800 shadow-sm\">\r\n                            <div>\r\n                                <label className=\"block text-xs font-bold text-graphite-500 uppercase mb-3\">Select Active Mantras</label>\r\n                                <div className=\"grid grid-cols-1 gap-2 max-h-[400px] overflow-y-auto pr-2\">\r\n                                    {allMantras.map((m, i) => (\r\n                                        <div key={i} onClick={() => setSelectedMantras(prev => prev.includes(m) ? prev.filter(x => x !== m) : [...prev, m])} className={`p-3 rounded-xl border cursor-pointer transition-all flex items-center justify-between ${selectedMantras.includes(m) ? 'bg-pacific-50 border-pacific-500 text-pacific-700 dark:bg-pacific-900/20 dark:text-pacific-300' : 'bg-graphite-50 dark:bg-graphite-950 border-transparent text-graphite-600 dark:text-graphite-400 hover:bg-graphite-100 dark:hover:bg-graphite-800'}`}>\r\n                                            <span className=\"text-sm font-medium\">{m}</span>\r\n                                            {selectedMantras.includes(m) && <CheckCircle2 size={16} />}\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"flex gap-2 pt-4 border-t border-graphite-200 dark:border-graphite-800\">\r\n                                <input value={newMantra} onChange={e => setNewMantra(e.target.value)} className=\"flex-1 bg-graphite-50 dark:bg-graphite-950 border border-graphite-200 dark:border-graphite-700 rounded-xl px-4 py-2 text-sm focus:outline-none focus:border-pacific-500 transition-colors\" placeholder=\"New Mantra...\" />\r\n                                <button onClick={handleAddMantra} className=\"px-4 bg-graphite-900 dark:bg-white text-white dark:text-graphite-900 rounded-xl font-bold text-xs uppercase tracking-wider\">ADD</button>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* GOALS TAB */}\r\n                    {activeTab === 'goals' && (\r\n                        <div className=\"max-w-3xl mx-auto animate-in fade-in slide-in-from-right-2 space-y-6\">\r\n                            <div className=\"flex justify-between items-center\">\r\n                                <h3 className=\"text-sm font-bold text-graphite-500 uppercase tracking-widest\">Active Goals</h3>\r\n                                <button onClick={openAddGoal} className=\"flex items-center gap-2 px-4 py-2 bg-pacific-600 text-white rounded-xl text-xs font-bold hover:bg-pacific-500 shadow-lg shadow-pacific-500/30 transition-colors\">\r\n                                    <Plus size={16} /> Add Goal\r\n                                </button>\r\n                            </div>\r\n                            <div className=\"space-y-3\">\r\n                                {localGoals.map((g) => (\r\n                                    <div key={g.id} className=\"p-4 bg-white dark:bg-graphite-900 border border-graphite-200 dark:border-graphite-800 rounded-2xl flex justify-between items-center group hover:border-pacific-500/30 transition-all shadow-sm\">\r\n                                        <div>\r\n                                            <div className=\"font-bold text-graphite-900 dark:text-white flex items-center gap-2\">\r\n                                                {g.title}\r\n                                                <span className={`text-[10px] uppercase px-2 py-0.5 rounded border ${g.type === GoalType.TASK_PROJECT ? 'border-purple-200 text-purple-600 dark:border-purple-900 dark:text-purple-400' : 'border-bali-200 text-bali-600 dark:border-bali-900 dark:text-bali-400'}`}>\r\n                                                    {g.type === GoalType.TASK_PROJECT ? 'Project' : 'Metric'}\r\n                                                </span>\r\n                                            </div>\r\n                                            <div className=\"text-xs text-graphite-500 mt-1 line-clamp-1\">{g.description}</div>\r\n                                        </div>\r\n                                        <div className=\"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity\">\r\n                                            <button onClick={() => openEditGoal(g)} className=\"p-2 text-graphite-400 hover:text-pacific-500 hover:bg-pacific-50 dark:hover:bg-pacific-900/20 rounded-lg transition-colors\"><Edit3 size={16} /></button>\r\n                                            <button\r\n                                                onClick={() => handleDeleteItem(g.id, 'goal')}\r\n                                                className={`p-2 rounded-lg transition-all flex items-center gap-2 ${verifyDeleteId === g.id ? 'bg-red-500 text-white w-24 justify-center' : 'text-graphite-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20'}`}\r\n                                            >\r\n                                                <Trash2 size={16} /> {verifyDeleteId === g.id && <span className=\"text-xs font-bold\">Confirm</span>}\r\n                                            </button>\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                                {localGoals.length === 0 && <div className=\"text-center py-12 text-graphite-400 italic bg-graphite-50 dark:bg-graphite-950 rounded-2xl border border-dashed border-graphite-200 dark:border-graphite-800\">No goals defined.</div>}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* HABITS TAB */}\r\n                    {activeTab === 'habits' && (\r\n                        <div className=\"max-w-3xl mx-auto animate-in fade-in slide-in-from-right-2 space-y-6\">\r\n                            <div className=\"flex justify-between items-center\">\r\n                                <h3 className=\"text-sm font-bold text-graphite-500 uppercase tracking-widest\">Cycle Habits</h3>\r\n                                <button onClick={openAddHabit} className=\"flex items-center gap-2 px-4 py-2 bg-pacific-600 text-white rounded-xl text-xs font-bold hover:bg-pacific-500 shadow-lg shadow-pacific-500/30 transition-colors\">\r\n                                    <Plus size={16} /> Add Habit\r\n                                </button>\r\n                            </div>\r\n                            <div className=\"space-y-3\">\r\n                                {localHabits.map((h) => (\r\n                                    <div key={h.id} className=\"p-4 bg-white dark:bg-graphite-900 border border-graphite-200 dark:border-graphite-800 rounded-2xl flex justify-between items-center group hover:border-pacific-500/30 transition-all shadow-sm\">\r\n                                        <div>\r\n                                            <div className=\"font-bold text-graphite-900 dark:text-white flex items-center gap-2\">\r\n                                                {h.name}\r\n                                                {h.linked_goal_id && <span className=\"text-[10px] uppercase px-2 py-0.5 rounded bg-pacific-50 dark:bg-pacific-900/20 text-pacific-600 dark:text-pacific-400 font-bold flex items-center gap-1\"><AlertTriangle size={10} /> Linked</span>}\r\n                                            </div>\r\n                                            <div className=\"text-xs text-graphite-500 mt-1 flex items-center gap-3\">\r\n                                                <span className=\"bg-graphite-100 dark:bg-graphite-800 px-2 py-0.5 rounded\">{h.category}</span>\r\n                                                <span>Weight: {h.weight}</span>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className=\"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity\">\r\n                                            <button onClick={() => openEditHabit(h)} className=\"p-2 text-graphite-400 hover:text-pacific-500 hover:bg-pacific-50 dark:hover:bg-pacific-900/20 rounded-lg transition-colors\"><Edit3 size={16} /></button>\r\n                                            <button\r\n                                                onClick={() => handleDeleteItem(h.id, 'habit')}\r\n                                                className={`p-2 rounded-lg transition-all flex items-center gap-2 ${verifyDeleteId === h.id ? 'bg-red-500 text-white w-24 justify-center' : 'text-graphite-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20'}`}\r\n                                            >\r\n                                                <Trash2 size={16} /> {verifyDeleteId === h.id && <span className=\"text-xs font-bold\">Confirm</span>}\r\n                                            </button>\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                                {localHabits.length === 0 && <div className=\"text-center py-12 text-graphite-400 italic bg-graphite-50 dark:bg-graphite-950 rounded-2xl border border-dashed border-graphite-200 dark:border-graphite-800\">No habits defined.</div>}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Footer Actions */}\r\n                <div className=\"p-6 border-t border-graphite-200 dark:border-graphite-800 flex justify-end gap-3 bg-white dark:bg-graphite-900 rounded-b-2xl\">\r\n                    <button onClick={onClose} className=\"px-6 py-2 text-sm font-bold text-graphite-500 hover:text-graphite-900 dark:hover:text-white transition-colors\">Close</button>\r\n                    <button onClick={handleFinalSave} className=\"px-8 py-2 bg-graphite-900 dark:bg-white text-white dark:text-graphite-900 rounded-xl text-sm font-bold shadow-lg hover:opacity-90 transition-opacity flex items-center gap-2\">\r\n                        {mode === 'create' ? <Rocket size={16} /> : <Save size={16} />}\r\n                        {mode === 'create' ? 'Initialize Cycle' : 'Save Cycle Config'}\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Sub-Modals */}\r\n                <GoalFormModal\r\n                    isOpen={isGoalModalOpen}\r\n                    onClose={() => setIsGoalModalOpen(false)}\r\n                    onSave={handleGoalSaveWrapper}\r\n                    initialGoal={editingGoal}\r\n                    allHabits={allHabits}\r\n                    currentCycleHabits={localHabits}\r\n                />\r\n                <HabitFormModal\r\n                    isOpen={isHabitModalOpen}\r\n                    onClose={() => setIsHabitModalOpen(false)}\r\n                    onSave={handleHabitSaveWrapper}\r\n                    initialHabit={editingHabit}\r\n                    allHabits={allHabits}\r\n                    onDeleteFromLibrary={handleDeleteFromLibrary}\r\n                    onRenameCategory={onRenameCategory}\r\n                    onDeleteCategory={onDeleteCategory}\r\n                />\r\n            </div>\r\n        </div>\r\n    )\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2779, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/20252128/dev/Projects/el-portal/src/app/%28portal%29/database/page.tsx"],"sourcesContent":["\r\n'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { supabaseService } from '@/lib/supabaseService';\r\nimport { Version, Cycle, EntityStatus, Habit, Goal, HabitWeight, GoalType } from '@/types/types';\r\nimport { Database, Search, ArrowUpRight, Trash2, Edit3, X, Save } from 'lucide-react';\r\nimport { GoalFormModal } from '@/components/GoalFormModal';\r\nimport { CycleEditorModal } from '@/components/CycleEditorModal';\r\nimport { HabitFormModal } from '@/components/HabitFormModal';\r\n\r\ntype TabType = 'versions' | 'cycles' | 'habits' | 'goals';\r\n\r\nconst EditModal = ({ isOpen, onClose, type, data, onSave, categories }: {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    type: TabType;\r\n    data: any;\r\n    onSave: (updatedData: any) => void;\r\n    categories?: string[];\r\n}) => {\r\n    const [formData, setFormData] = useState(data);\r\n\r\n    useEffect(() => {\r\n        setFormData(data);\r\n    }, [data]);\r\n\r\n    if (!isOpen || !formData) return null;\r\n\r\n    const handleChange = (field: string, value: any) => {\r\n        setFormData((prev: any) => ({ ...prev, [field]: value }));\r\n    };\r\n\r\n    const renderFields = () => {\r\n        switch (type) {\r\n            case 'versions':\r\n                return (\r\n                    <>\r\n                        <div className=\"space-y-1\">\r\n                            <label className=\"text-xs font-bold uppercase text-graphite-500\">Title</label>\r\n                            <input className=\"w-full bg-graphite-50 dark:bg-graphite-800 border border-graphite-200 dark:border-graphite-700 rounded-lg p-2 text-sm\"\r\n                                value={formData.title} onChange={e => handleChange('title', e.target.value)} />\r\n                        </div>\r\n                        <div className=\"space-y-1\">\r\n                            <label className=\"text-xs font-bold uppercase text-graphite-500\">Description</label>\r\n                            <textarea className=\"w-full bg-graphite-50 dark:bg-graphite-800 border border-graphite-200 dark:border-graphite-700 rounded-lg p-2 text-sm\"\r\n                                value={formData.description} onChange={e => handleChange('description', e.target.value)} rows={3} />\r\n                        </div>\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <div className=\"space-y-1\">\r\n                                <label className=\"text-xs font-bold uppercase text-graphite-500\">Start Date</label>\r\n                                <input type=\"date\" className=\"w-full bg-graphite-50 dark:bg-graphite-800 border border-graphite-200 dark:border-graphite-700 rounded-lg p-2 text-sm\"\r\n                                    value={formData.start_date} onChange={e => handleChange('start_date', e.target.value)} />\r\n                            </div>\r\n                            <div className=\"space-y-1\">\r\n                                <label className=\"text-xs font-bold uppercase text-graphite-500\">End Date</label>\r\n                                <input type=\"date\" className=\"w-full bg-graphite-50 dark:bg-graphite-800 border border-graphite-200 dark:border-graphite-700 rounded-lg p-2 text-sm\"\r\n                                    value={formData.end_date} onChange={e => handleChange('end_date', e.target.value)} />\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"space-y-1\">\r\n                            <label className=\"text-xs font-bold uppercase text-graphite-500\">Status</label>\r\n                            <select className=\"w-full bg-graphite-50 dark:bg-graphite-800 border border-graphite-200 dark:border-graphite-700 rounded-lg p-2 text-sm\"\r\n                                value={formData.status} onChange={e => handleChange('status', e.target.value)}>\r\n                                <option value={EntityStatus.ACTIVE}>Active</option>\r\n                                <option value={EntityStatus.ARCHIVED}>Archived</option>\r\n                            </select>\r\n                        </div>\r\n                    </>\r\n                );\r\n            case 'cycles':\r\n                // Handled by CycleEditorModal\r\n                return null;\r\n            case 'habits':\r\n                // Handled by HabitFormModal\r\n                return null;\r\n            case 'goals':\r\n                // Handled by GoalFormModal\r\n                return null;\r\n            default: return null;\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-graphite-950/80 backdrop-blur-sm p-4\" onClick={onClose}>\r\n            <div className=\"w-full max-w-lg rounded-2xl bg-white dark:bg-graphite-900 p-6 shadow-2xl border border-graphite-200 dark:border-graphite-800 animate-in zoom-in-95 duration-200\" onClick={e => e.stopPropagation()}>\r\n                <div className=\"flex justify-between items-center mb-6\">\r\n                    <h2 className=\"text-lg font-bold text-graphite-900 dark:text-white capitalize\">Edit {type.slice(0, -1)}</h2>\r\n                    <button onClick={onClose}><X size={20} className=\"text-graphite-400 hover:text-white\" /></button>\r\n                </div>\r\n                <div className=\"space-y-4 mb-6\">\r\n                    {renderFields()}\r\n                </div>\r\n                <div className=\"flex justify-end gap-3\">\r\n                    <button onClick={onClose} className=\"px-4 py-2 text-sm font-bold text-graphite-500 hover:text-graphite-900 dark:hover:text-white\">Cancel</button>\r\n                    <button onClick={() => onSave(formData)} className=\"px-6 py-2 bg-pacific-600 text-white rounded-xl text-sm font-bold shadow-lg shadow-pacific-500/30 flex items-center gap-2\">\r\n                        <Save size={16} /> Save Changes\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst DatabasePage: React.FC = () => {\r\n    const [versions, setVersions] = useState<Version[]>([]);\r\n    const [cycles, setCycles] = useState<Cycle[]>([]);\r\n    const [habits, setHabits] = useState<Habit[]>([]);\r\n    const [goals, setGoals] = useState<Goal[]>([]);\r\n    const [activeTab, setActiveTab] = useState<TabType>('versions');\r\n    const [verifyDeleteId, setVerifyDeleteId] = useState<string | null>(null);\r\n\r\n    const [editingItem, setEditingItem] = useState<{ type: TabType; data: any } | null>(null);\r\n\r\n    const loadData = async () => {\r\n        try {\r\n            const v = await supabaseService.getAllVersions();\r\n            const c = await supabaseService.getAllCycles();\r\n            const h = await supabaseService.getAllHabits();\r\n            const g = await supabaseService.getAllGoals();\r\n\r\n            setVersions(v);\r\n            setCycles(c);\r\n            setHabits(h);\r\n            setGoals(g);\r\n        } catch (err) {\r\n            console.error(err);\r\n        }\r\n    };\r\n\r\n    useEffect(() => { loadData(); }, []);\r\n\r\n    // Reset delete verification when changing tabs\r\n    useEffect(() => {\r\n        setVerifyDeleteId(null);\r\n    }, [activeTab]);\r\n\r\n    const handleDelete = async (id: string, type: TabType) => {\r\n        // 1. Check if we are verifying this specific ID\r\n        if (verifyDeleteId !== id) {\r\n            setVerifyDeleteId(id);\r\n            // Auto-reset after 3s\r\n            setTimeout(() => setVerifyDeleteId((prev: string | null) => prev === id ? null : prev), 3000);\r\n            return;\r\n        }\r\n\r\n        // 2. Already verifying, perform delete\r\n        try {\r\n            switch (type) {\r\n                case 'versions': await supabaseService.deleteVersion(id); break;\r\n                case 'cycles': await supabaseService.deleteCycle(id); break;\r\n                case 'habits': await supabaseService.deleteHabit(id); break;\r\n                case 'goals': await supabaseService.deleteGoal(id); break;\r\n            }\r\n            setVerifyDeleteId(null);\r\n            loadData();\r\n        } catch (e) {\r\n            console.error(\"Delete failed\", e);\r\n            loadData();\r\n        }\r\n    };\r\n\r\n    const handleEdit = (item: any) => {\r\n        setEditingItem({ type: activeTab, data: item });\r\n    };\r\n\r\n    const handleSaveEdit = async (updatedData: any) => {\r\n        const type = editingItem?.type;\r\n        if (!type) return;\r\n\r\n        switch (type) {\r\n            case 'versions': await supabaseService.updateVersion(updatedData); break;\r\n            case 'cycles': await supabaseService.updateCycle(updatedData); break;\r\n            // Habits and Goals are now handled by specific modals and handlers\r\n        }\r\n        setEditingItem(null);\r\n        loadData();\r\n    };\r\n\r\n    const handleGoalSave = async (goalData: { title: string; description: string; type: GoalType; subtasks?: string[] }, selectedHabit: Habit | null) => {\r\n        if (editingItem?.type !== 'goals' || !editingItem.data) return;\r\n        const originalGoal = editingItem.data as Goal;\r\n        const parsedSubtasks = goalData.subtasks?.map((rawName: string) => {\r\n            const match = rawName.match(/^(\\s*)/);\r\n            const leadingStr = match ? match[1] : '';\r\n            const normalizedIndent = leadingStr.replace(/\\t/g, '  ');\r\n            const level = Math.floor(normalizedIndent.length / 2);\r\n            return { name: rawName.trim(), done: false, level };\r\n        });\r\n\r\n        const updatedGoal: Goal = {\r\n            ...originalGoal,\r\n            title: goalData.title,\r\n            description: goalData.description,\r\n            type: goalData.type,\r\n            subtasks: parsedSubtasks,\r\n            linked_habit_id: selectedHabit?.id\r\n        };\r\n\r\n        await supabaseService.updateGoal(updatedGoal);\r\n        setEditingItem(null);\r\n        loadData();\r\n    };\r\n\r\n    const handleHabitSave = async (habitData: { name: string; category: string; weight: HabitWeight }) => {\r\n        if (editingItem?.type !== 'habits' || !editingItem.data) return;\r\n        const originalHabit = editingItem.data as Habit;\r\n        const updatedHabit: Habit = {\r\n            ...originalHabit,\r\n            name: habitData.name,\r\n            category: habitData.category,\r\n            weight: habitData.weight\r\n        };\r\n        await supabaseService.updateHabit(updatedHabit);\r\n        setEditingItem(null);\r\n        loadData();\r\n    };\r\n\r\n    const handleCycleManageGoal = async (action: 'create' | 'update' | 'delete', payload: any) => {\r\n        if (!editingItem?.data) return;\r\n        if (action === 'delete') {\r\n            await supabaseService.deleteGoal(payload.id);\r\n        } else {\r\n            // Simplified replication of Lab.tsx logic for Database view context\r\n            if (action === 'create') {\r\n                const newGoal: Goal = {\r\n                    id: `g-${crypto.randomUUID()}`,\r\n                    cycle_id: editingItem.data.id,\r\n                    title: payload.title,\r\n                    description: payload.description,\r\n                    type: payload.type,\r\n                    subtasks: payload.subtasks?.map((s: string) => ({ name: s.trim(), done: false, level: 0 })) || []\r\n                };\r\n                await supabaseService.addGoal(newGoal);\r\n            } else {\r\n                const originalGoal = goals.find((g: Goal) => g.id === payload.id);\r\n                if (originalGoal) {\r\n                    const updatedGoal = { ...originalGoal, ...payload };\r\n                    if (payload.subtasks && typeof payload.subtasks[0] === 'string') {\r\n                        updatedGoal.subtasks = payload.subtasks.map((s: string) => ({ name: s.trim(), done: false, level: 0 }));\r\n                    }\r\n                    await supabaseService.updateGoal(updatedGoal);\r\n                }\r\n            }\r\n        }\r\n        loadData();\r\n    };\r\n\r\n    const handleCycleManageHabit = async (action: 'create' | 'update' | 'delete', payload: any) => {\r\n        if (!editingItem?.data) return;\r\n        if (action === 'delete') {\r\n            await supabaseService.deleteHabit(payload.id);\r\n        } else if (action === 'create') {\r\n            const newHabit: Habit = {\r\n                id: `h-${crypto.randomUUID()}`,\r\n                cycle_id: editingItem.data.id,\r\n                name: payload.name,\r\n                category: payload.category,\r\n                weight: payload.weight\r\n            };\r\n            await supabaseService.addHabit(newHabit);\r\n        } else {\r\n            const originalHabit = habits.find((h: Habit) => h.id === payload.id);\r\n            if (originalHabit) {\r\n                await supabaseService.updateHabit({ ...originalHabit, ...payload });\r\n            }\r\n        }\r\n        loadData();\r\n    };\r\n\r\n    // Get unique categories for habits\r\n    const uniqueCategories = Array.from(new Set(habits.map((h: Habit) => h.category))).sort() as string[];\r\n\r\n    // Calculate current cycle habits for goal linking context\r\n    const activeCycle = cycles.find(c => c.status === EntityStatus.ACTIVE) || cycles[cycles.length - 1];\r\n    const currentCycleHabits = activeCycle ? habits.filter(h => h.cycle_id === activeCycle.id) : [];\r\n\r\n    const renderTable = () => {\r\n        let headers: string[] = [];\r\n        let rows: any[] = [];\r\n\r\n        switch (activeTab) {\r\n            case 'versions':\r\n                headers = ['Number', 'Title', 'Status', 'Dates', 'Actions'];\r\n                rows = versions.map((v: Version) => ({\r\n                    id: v.id,\r\n                    data: [\r\n                        <span className=\"font-medium\">v{v.number}.0</span>,\r\n                        v.title,\r\n                        <span className={`px-2 py-1 rounded text-xs font-bold uppercase ${v.status === EntityStatus.ACTIVE ? 'bg-bali-100 text-bali-700 dark:bg-bali-900/30 dark:text-bali-400' : 'bg-graphite-100 text-graphite-500 dark:bg-graphite-800'}`}>{v.status}</span>,\r\n                        <span className=\"text-xs font-mono text-graphite-500\">{v.start_date}  {v.end_date}</span>\r\n                    ],\r\n                    original: v\r\n                }));\r\n                break;\r\n            case 'cycles':\r\n                headers = ['Sprint #', 'Priorities', 'Version Link', 'Dates', 'Actions'];\r\n                rows = cycles.map((c: Cycle) => ({\r\n                    id: c.id,\r\n                    data: [\r\n                        `Cycle ${c.sprint_number}`,\r\n                        <div className=\"flex flex-col gap-1\">{c.focus_priorities.slice(0, 2).map((p: string, i: number) => <span key={i} className=\"text-xs\"> {p}</span>)}</div>,\r\n                        <span className=\"text-xs text-pacific-500 font-mono\">{c.version_id}</span>,\r\n                        <span className=\"text-xs font-mono text-graphite-500\">{c.start_date}  {c.end_date}</span>\r\n                    ],\r\n                    original: c\r\n                }));\r\n                break;\r\n            case 'habits':\r\n                headers = ['Name', 'Category', 'Weight', 'Cycle Link', 'Actions'];\r\n                rows = habits.map((h: Habit) => ({\r\n                    id: h.id,\r\n                    data: [\r\n                        <span className=\"font-medium\">{h.name}</span>,\r\n                        <span className=\"text-xs bg-graphite-100 dark:bg-graphite-800 px-2 py-1 rounded\">{h.category}</span>,\r\n                        <div className=\"flex gap-0.5\">{[...Array(h.weight)].map((_: any, i: number) => <div key={i} className=\"h-1.5 w-1.5 rounded-full bg-pacific-500\" />)}</div>,\r\n                        <span className=\"text-xs text-pacific-500 font-mono\">{h.cycle_id}</span>\r\n                    ],\r\n                    original: h\r\n                }));\r\n                break;\r\n            case 'goals':\r\n                headers = ['Title', 'Type', 'Cycle Link', 'Linked Habit', 'Actions'];\r\n                rows = goals.map((g: Goal) => ({\r\n                    id: g.id,\r\n                    data: [\r\n                        <span className=\"font-medium\">{g.title}</span>,\r\n                        <span className={`text-[10px] font-bold uppercase px-2 py-1 rounded border ${g.type === GoalType.TASK_PROJECT ? 'border-purple-200 text-purple-600 dark:border-purple-900 dark:text-purple-400' : 'border-bali-200 text-bali-600 dark:border-bali-900 dark:text-bali-400'}`}>{g.type === GoalType.TASK_PROJECT ? 'Project' : 'Consistency'}</span>,\r\n                        <span className=\"text-xs text-pacific-500 font-mono\">{g.cycle_id}</span>,\r\n                        g.linked_habit_id ? <span className=\"text-xs font-mono text-graphite-400\">{g.linked_habit_id.slice(0, 8)}...</span> : <span className=\"text-xs text-graphite-300\">-</span>\r\n                    ],\r\n                    original: g\r\n                }));\r\n                break;\r\n        }\r\n\r\n        return (\r\n            <table className=\"w-full text-left text-sm\">\r\n                <thead className=\"bg-graphite-50 dark:bg-graphite-800/50 text-graphite-500 uppercase font-bold text-xs sticky top-0 backdrop-blur-sm\">\r\n                    <tr>\r\n                        {headers.map((h, i) => <th key={i} className=\"px-6 py-3\">{h}</th>)}\r\n                    </tr>\r\n                </thead>\r\n                <tbody className=\"divide-y divide-graphite-200 dark:divide-graphite-800\">\r\n                    {rows.map(row => (\r\n                        <tr key={row.id} className=\"hover:bg-graphite-50 dark:hover:bg-graphite-800/30 transition-colors group\">\r\n                            {row.data.map((cell: any, i: number) => (\r\n                                <td key={i} className=\"px-6 py-4 text-graphite-700 dark:text-graphite-300 align-middle\">\r\n                                    {cell}\r\n                                </td>\r\n                            ))}\r\n                            <td className=\"px-6 py-4\">\r\n                                <div className=\"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity\">\r\n                                    <button onClick={() => handleEdit(row.original)} className=\"p-1.5 text-graphite-400 hover:text-pacific-500 hover:bg-pacific-50 dark:hover:bg-pacific-900/20 rounded-lg transition-colors\">\r\n                                        <Edit3 size={16} />\r\n                                    </button>\r\n                                    <button\r\n                                        onClick={() => handleDelete(row.id, activeTab)}\r\n                                        className={`p-1.5 rounded-lg transition-all duration-200 flex items-center gap-2 ${verifyDeleteId === row.id\r\n                                            ? 'bg-red-500 text-white px-3 shadow-lg shadow-red-500/30 opacity-100'\r\n                                            : 'text-graphite-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20'\r\n                                            }`}\r\n                                    >\r\n                                        <Trash2 size={16} />\r\n                                        {verifyDeleteId === row.id && (\r\n                                            <span className=\"text-xs font-bold animate-in fade-in slide-in-from-left-1\">Confirm</span>\r\n                                        )}\r\n                                    </button>\r\n                                </div>\r\n                            </td>\r\n                        </tr>\r\n                    ))}\r\n                </tbody>\r\n            </table>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-8 h-full flex flex-col\">\r\n            <header className=\"flex items-end justify-between border-b border-graphite-200 dark:border-graphite-800 pb-6\">\r\n                <div>\r\n                    <h2 className=\"text-xs font-bold uppercase tracking-widest text-graphite-500 mb-2\">\r\n                        System Records\r\n                    </h2>\r\n                    <h1 className=\"text-3xl font-display font-medium text-graphite-900 dark:text-white flex items-center gap-3\">\r\n                        <Database className=\"text-graphite-400\" />\r\n                        Database View\r\n                    </h1>\r\n                </div>\r\n            </header>\r\n\r\n            <div className=\"flex gap-4 border-b border-graphite-200 dark:border-graphite-800\">\r\n                {(['versions', 'cycles', 'habits', 'goals'] as TabType[]).map(tab => (\r\n                    <button\r\n                        key={tab}\r\n                        onClick={() => setActiveTab(tab)}\r\n                        className={`pb-3 text-sm font-bold uppercase tracking-wide transition-colors border-b-2 ${activeTab === tab ? 'border-pacific-500 text-pacific-700 dark:border-pacific-400 dark:text-pacific-400' : 'border-transparent text-graphite-500 hover:text-graphite-700 dark:hover:text-graphite-300'}`}\r\n                    >\r\n                        {tab}\r\n                    </button>\r\n                ))}\r\n            </div>\r\n\r\n            <div className=\"flex-1 overflow-auto bg-white dark:bg-graphite-900 border border-graphite-200 dark:border-graphite-800 rounded-lg shadow-sm\">\r\n                {renderTable()}\r\n                {(\r\n                    (activeTab === 'versions' && versions.length === 0) ||\r\n                    (activeTab === 'cycles' && cycles.length === 0) ||\r\n                    (activeTab === 'habits' && habits.length === 0) ||\r\n                    (activeTab === 'goals' && goals.length === 0)\r\n                ) && (\r\n                        <div className=\"p-12 text-center text-graphite-400 italic\">No records found in database.</div>\r\n                    )}\r\n            </div>\r\n\r\n            {editingItem && (\r\n                editingItem.type === 'goals' ? (\r\n                    <GoalFormModal\r\n                        isOpen={true}\r\n                        onClose={() => setEditingItem(null)}\r\n                        onSave={handleGoalSave}\r\n                        initialGoal={editingItem.data as Goal}\r\n                        allHabits={habits}\r\n                        currentCycleHabits={currentCycleHabits}\r\n                    />\r\n                ) : editingItem.type === 'cycles' ? (\r\n                    <CycleEditorModal\r\n                        cycle={editingItem.data as Cycle}\r\n                        goals={goals.filter((g: Goal) => g.cycle_id === editingItem.data.id)}\r\n                        habits={habits.filter((h: Habit) => h.cycle_id === editingItem.data.id)}\r\n                        allHabits={habits}\r\n                        onClose={() => setEditingItem(null)}\r\n                        onSaveCycle={handleSaveEdit}\r\n                        onManageGoal={handleCycleManageGoal}\r\n                        onManageHabit={handleCycleManageHabit}\r\n                        onRenameCategory={async (oldName: string, newName: string) => {\r\n                            const all = await supabaseService.getAllHabits();\r\n                            const targets = all.filter((h: Habit) => h.category === oldName);\r\n                            for (const h of targets) await supabaseService.updateHabit({ ...h, category: newName });\r\n                            await loadData();\r\n                        }}\r\n                        onDeleteCategory={async (catName: string) => {\r\n                            const all = await supabaseService.getAllHabits();\r\n                            const targets = all.filter((h: Habit) => h.category === catName);\r\n                            for (const h of targets) await supabaseService.updateHabit({ ...h, category: 'Uncategorized' });\r\n                            await loadData();\r\n                        }}\r\n                    />\r\n                ) : editingItem.type === 'habits' ? (\r\n                    <HabitFormModal\r\n                        isOpen={true}\r\n                        onClose={() => setEditingItem(null)}\r\n                        onSave={handleHabitSave}\r\n                        initialHabit={editingItem.data as Habit}\r\n                        allHabits={habits}\r\n                        onDeleteFromLibrary={(id: string) => handleDelete(id, 'habits')}\r\n                        onRenameCategory={async (oldName: string, newName: string) => {\r\n                            const all = await supabaseService.getAllHabits();\r\n                            const targets = all.filter((h: Habit) => h.category === oldName);\r\n                            for (const h of targets) await supabaseService.updateHabit({ ...h, category: newName });\r\n                            await loadData();\r\n                        }}\r\n                        onDeleteCategory={async (catName: string) => {\r\n                            const all = await supabaseService.getAllHabits();\r\n                            const targets = all.filter((h: Habit) => h.category === catName);\r\n                            for (const h of targets) await supabaseService.updateHabit({ ...h, category: 'Uncategorized' });\r\n                            await loadData();\r\n                        }}\r\n                    />\r\n                ) : (\r\n                    <EditModal\r\n                        isOpen={!!editingItem}\r\n                        onClose={() => setEditingItem(null)}\r\n                        type={editingItem.type}\r\n                        data={editingItem.data}\r\n                        onSave={handleSaveEdit}\r\n                        categories={uniqueCategories}\r\n                    />\r\n                )\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default DatabasePage;\r\n"],"names":[],"mappings":"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"}}]
}