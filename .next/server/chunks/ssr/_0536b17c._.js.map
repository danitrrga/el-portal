{"version":3,"sources":["../../../../node_modules/lucide-react/src/defaultAttributes.ts","../../../../node_modules/lucide-react/src/createLucideIcon.ts","../../../../src/lib/supabaseService.ts","../../../../src/types/types.ts"],"sourcesContent":["export default {\n  xmlns: 'http://www.w3.org/2000/svg',\n  width: 24,\n  height: 24,\n  viewBox: '0 0 24 24',\n  fill: 'none',\n  stroke: 'currentColor',\n  strokeWidth: 2,\n  strokeLinecap: 'round',\n  strokeLinejoin: 'round',\n};\n","import {\n  forwardRef,\n  createElement,\n  ReactSVG,\n  SVGProps,\n  ForwardRefExoticComponent,\n  RefAttributes,\n} from 'react';\nimport defaultAttributes from './defaultAttributes';\n\nexport type IconNode = [elementName: keyof ReactSVG, attrs: Record<string, string>][];\n\nexport type SVGAttributes = Partial<SVGProps<SVGSVGElement>>;\ntype ComponentAttributes = RefAttributes<SVGSVGElement> & SVGAttributes;\n\nexport interface LucideProps extends ComponentAttributes {\n  size?: string | number;\n  absoluteStrokeWidth?: boolean;\n}\n\nexport type LucideIcon = ForwardRefExoticComponent<LucideProps>;\n/**\n * Converts string to KebabCase\n * Copied from scripts/helper. If anyone knows how to properly import it here\n * then please fix it.\n *\n * @param {string} string\n * @returns {string} A kebabized string\n */\nexport const toKebabCase = (string: string) =>\n  string\n    .replace(/([a-z0-9])([A-Z])/g, '$1-$2')\n    .toLowerCase()\n    .trim();\n\nconst createLucideIcon = (iconName: string, iconNode: IconNode): LucideIcon => {\n  const Component = forwardRef<SVGSVGElement, LucideProps>(\n    (\n      {\n        color = 'currentColor',\n        size = 24,\n        strokeWidth = 2,\n        absoluteStrokeWidth,\n        className = '',\n        children,\n        ...rest\n      },\n      ref,\n    ) => {\n      return createElement(\n        'svg',\n        {\n          ref,\n          ...defaultAttributes,\n          width: size,\n          height: size,\n          stroke: color,\n          strokeWidth: absoluteStrokeWidth\n            ? (Number(strokeWidth) * 24) / Number(size)\n            : strokeWidth,\n          className: ['lucide', `lucide-${toKebabCase(iconName)}`, className].join(' '),\n          ...rest,\n        },\n        [\n          ...iconNode.map(([tag, attrs]) => createElement(tag, attrs)),\n          ...(Array.isArray(children) ? children : [children]),\n        ],\n      );\n    },\n  );\n\n  Component.displayName = `${iconName}`;\n\n  return Component;\n};\n\nexport default createLucideIcon;\n","\r\nimport { supabase } from './supabase';\r\nimport {\r\n    Profile, Version, Cycle, Habit, HabitLog,\r\n    Goal, ArchiveItem, Slide, DashboardData,\r\n    EntityStatus, GoalType, ArchiveType\r\n} from '@/types/types';\r\n\r\nexport class SupabaseService {\r\n\r\n    // -- AUTH & ALIASING --\r\n    // Helper to ensure we have a user and get their ID\r\n    private async getUserId(): Promise<string> {\r\n        const { data: { session } } = await supabase.auth.getSession();\r\n        if (!session?.user) throw new Error(\"Not authenticated\");\r\n        return session.user.id;\r\n    }\r\n\r\n    // Helper to get the full profile\r\n    async getProfile(): Promise<Profile | null> {\r\n        const userId = await this.getUserId();\r\n        const { data, error } = await supabase\r\n            .from('profiles')\r\n            .select('*')\r\n            .eq('id', userId)\r\n            .single();\r\n\r\n        if (error) {\r\n            console.error('Error fetching profile:', error);\r\n            return null;\r\n        }\r\n        return data;\r\n    }\r\n\r\n    // -- SYSTEM SETTINGS --\r\n    async getSystemSettings(): Promise<{ days: number; cycles: number }> {\r\n        const profile = await this.getProfile();\r\n        return {\r\n            days: profile?.version_days_default || 90,\r\n            cycles: profile?.cycles_per_version_default || 6\r\n        };\r\n    }\r\n\r\n    async updateProfile(updates: Partial<Profile>): Promise<void> {\r\n        const userId = await this.getUserId();\r\n        const { error } = await supabase\r\n            .from('profiles')\r\n            .update(updates)\r\n            .eq('id', userId);\r\n        if (error) throw error;\r\n    }\r\n\r\n    async uploadAvatar(file: File): Promise<string> {\r\n        const userId = await this.getUserId();\r\n        const fileExt = file.name.split('.').pop();\r\n        const fileName = `${userId}/avatar-${Date.now()}.${fileExt}`;\r\n        const filePath = `${fileName}`;\r\n\r\n        const { error: uploadError } = await supabase.storage\r\n            .from('el-portal-assets')\r\n            .upload(filePath, file, { upsert: true });\r\n\r\n        if (uploadError) throw uploadError;\r\n\r\n        const { data } = supabase.storage\r\n            .from('el-portal-assets')\r\n            .getPublicUrl(filePath);\r\n\r\n        return data.publicUrl;\r\n    }\r\n\r\n    async updateSystemSettings(days: number, cycles: number): Promise<void> {\r\n        const userId = await this.getUserId();\r\n        const { error } = await supabase\r\n            .from('profiles')\r\n            .update({ version_days_default: days, cycles_per_version_default: cycles })\r\n            .eq('id', userId);\r\n        if (error) throw error;\r\n    }\r\n\r\n    // -- ANALYTICS ALGORITHMS (Migrated from MockDB) --\r\n\r\n    // 3.1 Daily Performance Calculation\r\n    calculateDailyScore(habits: Habit[], logs: HabitLog[]): number {\r\n        if (habits.length === 0) return 0;\r\n\r\n        let totalWeight = 0;\r\n        let completedWeight = 0;\r\n\r\n        habits.forEach(habit => {\r\n            totalWeight += habit.weight;\r\n            // Check if log exists for this habit\r\n            const isDone = logs.some(l => l.habit_id === habit.id && l.status);\r\n            if (isDone) {\r\n                completedWeight += habit.weight;\r\n            }\r\n        });\r\n\r\n        if (totalWeight === 0) return 0;\r\n        return Math.round((completedWeight / totalWeight) * 100);\r\n    }\r\n\r\n    // 3.2 Asymptotic Goal Progression\r\n    calculateAsymptoticScore(streak: number): number {\r\n        // Constraint: 7 days = ~35%\r\n        // Formula: Progress % = 100 * (1 - e^(-0.061 * StreakDays))\r\n        if (streak <= 0) return 0;\r\n        const progress = 100 * (1 - Math.exp(-0.061 * streak));\r\n        return Math.min(100, Math.round(progress));\r\n    }\r\n\r\n    private calculateHabitStreaks(habitId: string, allLogs: HabitLog[]): { currentStreak: number, maxStreak: number } {\r\n        // Filter logs for this habit and ensure they are 'true' (completed)\r\n        const logs = allLogs.filter(l => l.habit_id === habitId && l.status);\r\n        const dates = Array.from(new Set(logs.map(l => l.date))).sort();\r\n\r\n        if (dates.length === 0) return { currentStreak: 0, maxStreak: 0 };\r\n\r\n        // Max Streak Calculation\r\n        let max = 0;\r\n        let current = 0;\r\n        let prevTimestamp: number | null = null;\r\n\r\n        for (const dStr of dates) {\r\n            const timestamp = new Date(dStr).getTime();\r\n            if (prevTimestamp) {\r\n                const diffDays = Math.round((timestamp - prevTimestamp) / (1000 * 3600 * 24));\r\n                if (diffDays === 1) {\r\n                    current++;\r\n                } else {\r\n                    max = Math.max(max, current);\r\n                    current = 1;\r\n                }\r\n            } else {\r\n                current = 1;\r\n            }\r\n            prevTimestamp = timestamp;\r\n        }\r\n        max = Math.max(max, current);\r\n\r\n        // Current Streak Calculation\r\n        let streak = 0;\r\n        const today = new Date();\r\n        const todayStr = today.toISOString().split('T')[0];\r\n\r\n        const yesterday = new Date(today);\r\n        yesterday.setDate(yesterday.getDate() - 1);\r\n        const yesterdayStr = yesterday.toISOString().split('T')[0];\r\n\r\n        // Determine start point\r\n        let checkDate: Date | null = null;\r\n\r\n        if (dates.includes(todayStr)) {\r\n            streak = 1;\r\n            checkDate = new Date(today);\r\n        } else if (dates.includes(yesterdayStr)) {\r\n            streak = 1;\r\n            checkDate = new Date(yesterday);\r\n        }\r\n\r\n        if (checkDate) {\r\n            while (true) {\r\n                checkDate.setDate(checkDate.getDate() - 1);\r\n                const checkStr = checkDate.toISOString().split('T')[0];\r\n                if (dates.includes(checkStr)) {\r\n                    streak++;\r\n                } else {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        return { currentStreak: streak, maxStreak: max };\r\n    }\r\n\r\n    // -- DATA FETCHING --\r\n\r\n    async getDashboardData(): Promise<DashboardData> {\r\n        const profile = await this.getProfile();\r\n        if (!profile) throw new Error(\"Profile not found\");\r\n\r\n        // 1. Fetch current version & cycle details if they exist\r\n        let currentVersion: Version | null = null;\r\n        let currentCycle: Cycle | null = null;\r\n\r\n        if (profile.current_version_id) {\r\n            const { data } = await supabase.from('versions').select('*').eq('id', profile.current_version_id).single();\r\n            currentVersion = data;\r\n        }\r\n\r\n        if (profile.current_cycle_id) {\r\n            const { data } = await supabase.from('cycles').select('*').eq('id', profile.current_cycle_id).single();\r\n            currentCycle = data;\r\n        }\r\n\r\n        // 2. Fetch Habits & Goals for Current Cycle\r\n        let habits: Habit[] = [];\r\n        let goals: Goal[] = [];\r\n\r\n        if (currentCycle) {\r\n            const { data: hData } = await supabase.from('habits').select('*').eq('cycle_id', currentCycle.id);\r\n            habits = hData || [];\r\n\r\n            const { data: gData } = await supabase.from('goals').select('*').eq('cycle_id', currentCycle.id);\r\n            goals = gData || [];\r\n        }\r\n\r\n        // 3. Fetch Logs (Optimization: Fetch all logs for these habits? Or just active ones?)\r\n        // For streaks we need history. Let's fetch logs for these habits.\r\n        let logs: HabitLog[] = [];\r\n        if (habits.length > 0) {\r\n            const habitIds = habits.map(h => h.id);\r\n            const { data: lData } = await supabase.from('habit_logs').select('*').in('habit_id', habitIds);\r\n            logs = lData || [];\r\n        }\r\n\r\n        // 4. Calculate Stats\r\n        const todayStr = new Date().toISOString().split('T')[0];\r\n        const todayLogs = logs.filter(l => l.date === todayStr);\r\n\r\n        const habitStats: Record<string, { currentStreak: number; maxStreak: number }> = {};\r\n        habits.forEach(h => {\r\n            habitStats[h.id] = this.calculateHabitStreaks(h.id, logs);\r\n        });\r\n\r\n        return {\r\n            version: currentVersion,\r\n            cycle: currentCycle,\r\n            habits,\r\n            todayLogs,\r\n            habitStats,\r\n            goals\r\n        };\r\n    }\r\n\r\n    // -- ACTIONS --\r\n\r\n    async toggleHabit(habitId: string, isChecked: boolean): Promise<void> {\r\n        const userId = await this.getUserId();\r\n        const todayStr = new Date().toISOString().split('T')[0];\r\n\r\n        if (isChecked) {\r\n            // INSERT log\r\n            const { error } = await supabase.from('habit_logs').insert({\r\n                habit_id: habitId,\r\n                date: todayStr,\r\n                status: true,\r\n                user_id: userId\r\n            });\r\n            if (error) throw error;\r\n\r\n            // Update Goal Streak if linked\r\n            // Fetch habit to check link\r\n            const { data: habit } = await supabase.from('habits').select('linked_goal_id').eq('id', habitId).single();\r\n            if (habit && habit.linked_goal_id) {\r\n                // Increment goal streak\r\n                await supabase.rpc('increment_goal_streak', { goal_id: habit.linked_goal_id });\r\n                // Note: We might need to implement this RPC or do it in two steps (fetch, update)\r\n                // For now, let's do fetch-update safely\r\n                const { data: goal } = await supabase.from('goals').select('current_streak').eq('id', habit.linked_goal_id).single();\r\n                if (goal) {\r\n                    await supabase.from('goals').update({ current_streak: (goal.current_streak || 0) + 1 }).eq('id', habit.linked_goal_id);\r\n                }\r\n            }\r\n\r\n        } else {\r\n            // DELETE log\r\n            const { error } = await supabase.from('habit_logs').delete()\r\n                .eq('habit_id', habitId)\r\n                .eq('date', todayStr);\r\n\r\n            if (error) throw error;\r\n\r\n            // Decrement Goal Streak\r\n            const { data: habit } = await supabase.from('habits').select('linked_goal_id').eq('id', habitId).single();\r\n            if (habit && habit.linked_goal_id) {\r\n                const { data: goal } = await supabase.from('goals').select('current_streak').eq('id', habit.linked_goal_id).single();\r\n                if (goal) {\r\n                    await supabase.from('goals').update({ current_streak: Math.max(0, (goal.current_streak || 0) - 1) }).eq('id', habit.linked_goal_id);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // -- SLIDES (Storage + DB) --\r\n    async getSlides(): Promise<Slide[]> {\r\n        const { data } = await supabase.from('slides').select('*').order('category');\r\n        if (!data) return [];\r\n\r\n        return Promise.all(data.map(async (s) => {\r\n            if (s.image_url && !s.image_url.startsWith('http')) {\r\n                const { data: signed } = await supabase.storage\r\n                    .from('el-portal-assets')\r\n                    .createSignedUrl(s.image_url, 3600); // 1 hour expiry\r\n                if (signed) {\r\n                    return { ...s, image_url: signed.signedUrl };\r\n                }\r\n            }\r\n            return s;\r\n        }));\r\n    }\r\n\r\n    async updateSlide(slide: Slide, imageFile?: File): Promise<void> {\r\n        const userId = await this.getUserId();\r\n        let imageUrl = slide.image_url;\r\n\r\n        if (imageFile) {\r\n            // Upload to Supabase Storage\r\n            const fileExt = imageFile.name.split('.').pop();\r\n            const fileName = `${userId}/${slide.category}.${fileExt}`;\r\n            const filePath = `${fileName}`; // e.g., \"user_id/Me.jpg\"\r\n\r\n            const { error: uploadError } = await supabase.storage\r\n                .from('el-portal-assets')\r\n                .upload(filePath, imageFile, { upsert: true });\r\n\r\n            if (uploadError) throw uploadError;\r\n\r\n            // Ensure we store the PATH, or the Signed URL. \r\n            // Storing the PATH is cleaner, we generate Signed URL on read.\r\n            // BUT `getSlides` returns `image_url`. The UI expects a usable URL.\r\n            // So we should probably store the public URL if public, or generate signed urls on fetch.\r\n            // Since it's private data, we must generate signed URLs.\r\n            // For simplicity in this step, let's store the path and handle \"view\" logic in `getSlides` or separate method.\r\n            // However, the interface expects `image_url`. \r\n            // Let's store the path in DB `image_url` column for now, and have a helper to sign it.\r\n            imageUrl = filePath;\r\n        }\r\n\r\n        // Update DB Record\r\n        // Check if exists\r\n        const { data: existing } = await supabase.from('slides').select('id').eq('category', slide.category).single();\r\n\r\n        if (existing) {\r\n            await supabase.from('slides').update({\r\n                image_url: imageUrl,\r\n                caption: slide.caption\r\n            }).eq('id', existing.id);\r\n        } else {\r\n            await supabase.from('slides').insert({\r\n                user_id: userId,\r\n                category: slide.category,\r\n                image_url: imageUrl,\r\n                caption: slide.caption\r\n            });\r\n        }\r\n    }\r\n\r\n    // Helper to get actual viewable URL\r\n    // The UI might need to call this.\r\n    async getSlideImageUrl(path: string): Promise<string> {\r\n        if (!path) return '';\r\n        if (path.startsWith('http')) return path; // Already a URL (e.g. seed data)\r\n\r\n        const { data } = await supabase.storage.from('el-portal-assets').createSignedUrl(path, 3600); // 1 hour\r\n        return data?.signedUrl || '';\r\n    }\r\n\r\n    // -- ARCHIVES --\r\n    async getArchives(): Promise<ArchiveItem[]> {\r\n        const { data } = await supabase.from('archives').select('*');\r\n\r\n        // Map content (JSONB) back to string if needed by UI types\r\n        // The Type definition says `content: string`. \r\n        // If we stored `{markdown: \"...\"}`, we need to extract it.\r\n\r\n        return (data || []).map(row => ({\r\n            ...row,\r\n            content: typeof row.content === 'object' && row.content?.markdown ? row.content.markdown : row.content\r\n        }));\r\n    }\r\n\r\n    async updateArchive(item: ArchiveItem): Promise<void> {\r\n        const userId = await this.getUserId();\r\n        const contentJson = { markdown: item.content };\r\n\r\n        // Check if exists\r\n        const { data: existing } = await supabase.from('archives').select('id').eq('id', item.id).maybeSingle();\r\n\r\n        if (existing) {\r\n            await supabase.from('archives').update({\r\n                type: item.type,\r\n                title: item.title,\r\n                content: contentJson\r\n            }).eq('id', item.id);\r\n        } else {\r\n            await supabase.from('archives').insert({\r\n                id: item.id, // Use client-generated ID if provided? Or let DB generate?\r\n                // The interface has ID. Ideally let's upsert based on ID.\r\n                user_id: userId,\r\n                type: item.type,\r\n                title: item.title,\r\n                content: contentJson\r\n            });\r\n        }\r\n    }\r\n\r\n    // -- MISC Helpers --\r\n    // -- HISTORY & ANALYTICS --\r\n\r\n    async getHistoryData(): Promise<{\r\n        dailyScores: { date: string; score: number; details: any[] }[],\r\n        cycles: Cycle[],\r\n        habitStats: Record<string, { currentStreak: number; maxStreak: number }>\r\n    }> {\r\n        const userId = await this.getUserId();\r\n\r\n        // 1. Fetch range\r\n        const today = new Date();\r\n        const ninetyDaysAgo = new Date();\r\n        ninetyDaysAgo.setDate(today.getDate() - 90);\r\n        const startDateStr = ninetyDaysAgo.toISOString().split('T')[0];\r\n\r\n        // 2. Fetch Logs\r\n        const { data: logsData } = await supabase\r\n            .from('habit_logs')\r\n            .select('*')\r\n            .eq('user_id', userId)\r\n            .gte('date', startDateStr);\r\n        const logs = logsData || [];\r\n\r\n        // 3. Fetch Habits (All of them to map names, or just current? History implies past habits too)\r\n        // For accurate score, we need habits active ON THAT DATE. \r\n        // Our current schema links habits to cycles, and cycles have dates.\r\n        // Simplification: We will fetch ALL habits and cycles to reconstruct context.\r\n        const { data: habitsData } = await supabase.from('habits').select('*').eq('user_id', userId);\r\n        const habits = habitsData || [];\r\n\r\n        const { data: cyclesData } = await supabase.from('cycles').select('*').eq('user_id', userId);\r\n        const cycles = cyclesData || [];\r\n\r\n        // 4. Calculate Stats (Streaks)\r\n        const habitStats: Record<string, { currentStreak: number; maxStreak: number }> = {};\r\n        habits.forEach(h => {\r\n            // We pass ALL logs to streak calc, it handles filtering by habit_id\r\n            habitStats[h.id] = this.calculateHabitStreaks(h.id, logs);\r\n        });\r\n\r\n        // 5. Build Daily Scores\r\n        const dailyScores = [];\r\n        for (let i = 0; i <= 90; i++) {\r\n            const d = new Date(ninetyDaysAgo);\r\n            d.setDate(d.getDate() + i);\r\n            const dateStr = d.toISOString().split('T')[0];\r\n            if (dateStr > today.toISOString().split('T')[0]) break; // Don't go into future\r\n\r\n            // Find active cycle for this date\r\n            const activeCycle = cycles.find(c => c.start_date <= dateStr && c.end_date >= dateStr);\r\n\r\n            // Find habits linked to this cycle\r\n            const daysHabits = activeCycle\r\n                ? habits.filter(h => h.cycle_id === activeCycle.id)\r\n                : [];\r\n\r\n            const dayLogs = logs.filter(l => l.date === dateStr);\r\n\r\n            let score = 0;\r\n            const details: any[] = []; // Explicitly typed as any[] or match interface if possible\r\n\r\n            if (daysHabits.length > 0) {\r\n                score = this.calculateDailyScore(daysHabits, dayLogs);\r\n\r\n                // Populate details for HistoryPage inspector\r\n                daysHabits.forEach(h => {\r\n                    const isDone = dayLogs.some(l => l.habit_id === h.id && l.status);\r\n                    details.push({\r\n                        habit: h,\r\n                        done: isDone\r\n                    });\r\n                });\r\n            }\r\n\r\n            dailyScores.push({\r\n                date: dateStr,\r\n                score,\r\n                details\r\n            });\r\n        }\r\n\r\n        return {\r\n            dailyScores: dailyScores.reverse(), // Newest first usually? Or UI sorts? Dashboard slices -14.\r\n            cycles, // Return all cycles\r\n            habitStats\r\n        };\r\n    }\r\n\r\n    // -- VERSION MANAGEMENT --\r\n    async createVersion(data: { title: string; description: string; number: number; startDate: string }): Promise<Version> {\r\n        const userId = await this.getUserId();\r\n        const profile = await this.getProfile();\r\n\r\n        const defaultDays = profile?.version_days_default || 90;\r\n        const start = new Date(data.startDate);\r\n        const end = new Date(start);\r\n        end.setDate(start.getDate() + defaultDays);\r\n\r\n        const { data: newVersion, error } = await supabase.from('versions').insert({\r\n            user_id: userId,\r\n            number: data.number,\r\n            title: data.title,\r\n            description: data.description,\r\n            status: EntityStatus.ACTIVE,\r\n            start_date: data.startDate,\r\n            end_date: end.toISOString().split('T')[0]\r\n        }).select().single();\r\n\r\n        if (error) throw error;\r\n\r\n        // Update Profile\r\n        await supabase.from('profiles').update({ current_version_id: newVersion.id }).eq('id', userId);\r\n\r\n        return newVersion;\r\n    }\r\n\r\n    // -- GOAL MANAGEMENT --\r\n    async updateGoal(updatedGoal: Goal): Promise<void> {\r\n        const { error } = await supabase.from('goals').update({\r\n            title: updatedGoal.title,\r\n            description: updatedGoal.description,\r\n            type: updatedGoal.type,\r\n            subtasks: updatedGoal.subtasks, // JSONB\r\n            current_streak: updatedGoal.current_streak\r\n        }).eq('id', updatedGoal.id);\r\n\r\n        if (error) throw error;\r\n    }\r\n\r\n    // -- MANTRA MANAGEMENT --\r\n    async getMantras(): Promise<string[]> {\r\n        const userId = await this.getUserId();\r\n\r\n        // 1. Get from Cycles\r\n        const { data: cycles } = await supabase.from('cycles').select('mantras').eq('user_id', userId);\r\n        const cycleMantras = new Set<string>();\r\n        cycles?.forEach((c: any) => c.mantras?.forEach((m: string) => cycleMantras.add(m)));\r\n\r\n        // 2. Get from Archives (Mantra Bank)\r\n        const { data: archives } = await supabase\r\n            .from('archives')\r\n            .select('content')\r\n            .eq('user_id', userId)\r\n            .eq('type', ArchiveType.MANTRA_BANK);\r\n\r\n        archives?.forEach(a => {\r\n            // content might be jsonb or string depending on how we saved.\r\n            // Our Schema says content is jsonb, but addMantra saves it. \r\n            // Let's assume content field in archive holds the string in 'markdown' prop or similar if structured, \r\n            // but for Mantras specifically we might just store the string or { text: ... }\r\n            // Wait, previous implem used `content: text` in addMantra.\r\n            // Let's coerce.\r\n            const text = typeof a.content === 'object' && (a.content as any).markdown\r\n                ? (a.content as any).markdown\r\n                : JSON.stringify(a.content); // Fallback\r\n            cycleMantras.add(text);\r\n        });\r\n\r\n        return Array.from(cycleMantras);\r\n    }\r\n\r\n    async addMantra(text: string): Promise<void> {\r\n        const userId = await this.getUserId();\r\n\r\n        // Check duplication in archives\r\n        // Hard to check JSONB equality easily in one query without precise structure.\r\n        // We'll just insert.\r\n\r\n        await supabase.from('archives').insert({\r\n            user_id: userId,\r\n            type: ArchiveType.MANTRA_BANK,\r\n            title: 'Mantra',\r\n            content: { markdown: text }\r\n        });\r\n    }\r\n\r\n    // -- CYCLE CREATION (Complex Transaction) --\r\n    async createCycle(\r\n        cycleData: Omit<Cycle, 'id' | 'version_id' | 'start_date' | 'end_date' | 'sprint_number'>,\r\n        goalsData: Array<{ title: string; description: string; type: GoalType; subtasks?: string[]; habit?: { name: string; weight: number; category: string } }>,\r\n        standaloneHabits: Array<{ name: string; weight: number; category: string }>\r\n    ): Promise<Cycle> {\r\n        const userId = await this.getUserId();\r\n        const profile = await this.getProfile();\r\n        if (!profile?.current_version_id) throw new Error(\"No active version\");\r\n\r\n        // 1. Calculate Sprint Number\r\n        const { count } = await supabase\r\n            .from('cycles')\r\n            .select('*', { count: 'exact', head: true })\r\n            .eq('version_id', profile.current_version_id);\r\n\r\n        const sprintNum = (count || 0) + 1;\r\n\r\n        // 2. Create Cycle\r\n        const { data: newCycle, error: cycleError } = await supabase.from('cycles').insert({\r\n            user_id: userId,\r\n            version_id: profile.current_version_id,\r\n            sprint_number: sprintNum,\r\n            start_date: new Date().toISOString().split('T')[0], // Default today\r\n            end_date: new Date(Date.now() + 14 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],\r\n            status: EntityStatus.ACTIVE,\r\n            focus_priorities: cycleData.focus_priorities,\r\n            problems: cycleData.problems,\r\n            cch_list: cycleData.cch_list,\r\n            mantras: cycleData.mantras,\r\n            learning_focus: cycleData.learning_focus\r\n        }).select().single();\r\n\r\n        if (cycleError) throw cycleError;\r\n\r\n        // 3. Create Goals & Linked Habits\r\n        for (const gData of goalsData) {\r\n            // Insert Goal first (without habit link)\r\n            const { data: goal, error: gError } = await supabase.from('goals').insert({\r\n                user_id: userId,\r\n                cycle_id: newCycle.id,\r\n                title: gData.title,\r\n                description: gData.description,\r\n                type: gData.type,\r\n                subtasks: gData.subtasks?.map(name => ({ name, done: false })),\r\n            }).select().single();\r\n\r\n            if (gError) console.error(\"Error creating goal\", gError);\r\n\r\n            if (gData.habit && goal) {\r\n                // Create Linked Habit\r\n                const { data: habit, error: hError } = await supabase.from('habits').insert({\r\n                    user_id: userId,\r\n                    cycle_id: newCycle.id,\r\n                    name: gData.habit.name,\r\n                    weight: gData.habit.weight,\r\n                    category: gData.habit.category,\r\n                    linked_goal_id: goal.id\r\n                }).select().single();\r\n\r\n                // Update Goal with linked_habit_id\r\n                if (habit) {\r\n                    await supabase.from('goals').update({ linked_habit_id: habit.id }).eq('id', goal.id);\r\n                }\r\n            }\r\n        }\r\n\r\n        // 4. Create Standalone Habits\r\n        for (const hData of standaloneHabits) {\r\n            await supabase.from('habits').insert({\r\n                user_id: userId,\r\n                cycle_id: newCycle.id,\r\n                name: hData.name,\r\n                weight: hData.weight,\r\n                category: hData.category\r\n            });\r\n        }\r\n\r\n        // 5. Update Profile\r\n        await supabase.from('profiles').update({ current_cycle_id: newCycle.id }).eq('id', userId);\r\n\r\n        return newCycle;\r\n    }\r\n\r\n    // -- LAB METHODS --\r\n\r\n    async getLabData(): Promise<{ goals: Goal[]; version: Version | null; cycles: Cycle[]; habits: Habit[]; activeCycleId: string | null }> {\r\n        const userId = await this.getUserId();\r\n        const profile = await this.getProfile();\r\n\r\n        // Fetch Versions (to find current)\r\n        const { data: versions } = await supabase.from('versions').select('*').eq('user_id', userId);\r\n        const currentVersion = versions?.find(v => v.id === profile?.current_version_id) || null;\r\n\r\n        // Fetch Cycles\r\n        const { data: cycles } = await supabase.from('cycles').select('*').eq('user_id', userId).order('sprint_number', { ascending: false });\r\n        // Filter cycles for current version if exists\r\n        const versionCycles = currentVersion\r\n            ? (cycles || []).filter(c => c.version_id === currentVersion.id)\r\n            : [];\r\n\r\n        // Fetch ALL Goals and Habits (Lab needs access to database/library)\r\n        const { data: goals } = await supabase.from('goals').select('*').eq('user_id', userId);\r\n        const { data: habits } = await supabase.from('habits').select('*').eq('user_id', userId);\r\n\r\n        return {\r\n            goals: goals || [],\r\n            version: currentVersion,\r\n            cycles: versionCycles,\r\n            habits: habits || [],\r\n            activeCycleId: profile?.current_cycle_id || null\r\n        };\r\n    }\r\n\r\n    async updateCycle(cycle: Cycle): Promise<void> {\r\n        const { error } = await supabase.from('cycles').update({\r\n            start_date: cycle.start_date,\r\n            end_date: cycle.end_date,\r\n            status: cycle.status,\r\n            focus_priorities: cycle.focus_priorities,\r\n            problems: cycle.problems,\r\n            cch_list: cycle.cch_list,\r\n            mantras: cycle.mantras,\r\n            learning_focus: cycle.learning_focus\r\n        }).eq('id', cycle.id);\r\n        if (error) throw error;\r\n    }\r\n\r\n    async deleteCycle(cycleId: string): Promise<void> {\r\n        const userId = await this.getUserId();\r\n        // Constraints: Goals/Habits restricted by foreign key? \r\n        // Our schema might have cascade delete. If not, we do manual cleanup.\r\n        // Assuming CASCADE is ON for Foreign Keys in Schema.\r\n        const { error } = await supabase.from('cycles').delete().eq('id', cycleId);\r\n        if (error) throw error;\r\n\r\n        // Update Profile if active cycle was deleted\r\n        const profile = await this.getProfile();\r\n        if (profile?.current_cycle_id === cycleId) {\r\n            // Pick another or null\r\n            // We just set to null, let UI handle or User pick\r\n            await supabase.from('profiles').update({ current_cycle_id: null }).eq('id', userId);\r\n        }\r\n    }\r\n\r\n    async setCycleActive(cycleId: string): Promise<void> {\r\n        const userId = await this.getUserId();\r\n        await supabase.from('profiles').update({ current_cycle_id: cycleId }).eq('id', userId);\r\n    }\r\n\r\n    // -- GOAL CRUD --\r\n    async addGoal(goal: Goal): Promise<void> {\r\n        const userId = await this.getUserId();\r\n        // Goal ID might be pre-generated by UI or we let DB generate. \r\n        // DB uses uuid_generate_v4() default.\r\n        // If UI sends ID, we use it. `goal.id` from `Lab.tsx` usage is `g-UUID`.\r\n        // We need to respect that ID if we want optimistic UI to match.\r\n        // But our DB calls `gen_random_uuid()`. \r\n        // Either we insert with ID or we let DB decide. \r\n        // Supabase allows inserting ID.\r\n\r\n        const { error } = await supabase.from('goals').insert({\r\n            id: goal.id, // Explicit ID from UI\r\n            user_id: userId,\r\n            cycle_id: goal.cycle_id,\r\n            title: goal.title,\r\n            description: goal.description,\r\n            type: goal.type,\r\n            subtasks: goal.subtasks?.map((s: any) => ({ ...s, name: s.name, done: s.done })), // Sanitation\r\n            linked_habit_id: goal.linked_habit_id,\r\n            current_streak: goal.current_streak\r\n        });\r\n        if (error) throw error;\r\n    }\r\n\r\n    async deleteGoal(goalId: string): Promise<void> {\r\n        const { error } = await supabase.from('goals').delete().eq('id', goalId);\r\n        if (error) throw error;\r\n    }\r\n\r\n    // -- HABIT CRUD --\r\n    async getAllHabits(): Promise<Habit[]> {\r\n        const userId = await this.getUserId();\r\n        const { data } = await supabase.from('habits').select('*').eq('user_id', userId);\r\n        return data || [];\r\n    }\r\n\r\n    async addHabit(habit: Habit): Promise<void> {\r\n        const userId = await this.getUserId();\r\n        const { error } = await supabase.from('habits').insert({\r\n            id: habit.id,\r\n            user_id: userId,\r\n            cycle_id: habit.cycle_id,\r\n            name: habit.name,\r\n            weight: habit.weight,\r\n            category: habit.category,\r\n            linked_goal_id: habit.linked_goal_id\r\n        });\r\n        if (error) throw error;\r\n    }\r\n\r\n    async updateHabit(habit: Habit): Promise<void> {\r\n        const { error } = await supabase.from('habits').update({\r\n            name: habit.name,\r\n            weight: habit.weight,\r\n            category: habit.category,\r\n            linked_goal_id: habit.linked_goal_id\r\n        }).eq('id', habit.id);\r\n        if (error) throw error;\r\n    }\r\n\r\n    async deleteHabit(habitId: string): Promise<void> {\r\n        const { error } = await supabase.from('habits').delete().eq('id', habitId);\r\n        if (error) throw error;\r\n    }\r\n\r\n    // -- DATABASE PAGE HELPERS --\r\n\r\n    async getAllVersions(): Promise<Version[]> {\r\n        const userId = await this.getUserId();\r\n        const { data } = await supabase.from('versions').select('*').eq('user_id', userId).order('start_date', { ascending: false });\r\n        return data || [];\r\n    }\r\n\r\n    async updateVersion(version: Version): Promise<void> {\r\n        const { error } = await supabase.from('versions').update({\r\n            title: version.title,\r\n            description: version.description,\r\n            start_date: version.start_date,\r\n            end_date: version.end_date,\r\n            status: version.status\r\n        }).eq('id', version.id);\r\n        if (error) throw error;\r\n    }\r\n\r\n    async deleteVersion(versionId: string): Promise<void> {\r\n        const { error } = await supabase.from('versions').delete().eq('id', versionId);\r\n        if (error) throw error;\r\n    }\r\n\r\n    async getAllCycles(): Promise<Cycle[]> {\r\n        const userId = await this.getUserId();\r\n        const { data } = await supabase.from('cycles').select('*').eq('user_id', userId).order('sprint_number', { ascending: false });\r\n        return data || [];\r\n    }\r\n\r\n    async getAllGoals(): Promise<Goal[]> {\r\n        const userId = await this.getUserId();\r\n        const { data } = await supabase.from('goals').select('*').eq('user_id', userId);\r\n        return data || [];\r\n    }\r\n\r\n    async signOut(): Promise<void> {\r\n        await supabase.auth.signOut();\r\n    }\r\n}\r\n\r\nexport const supabaseService = new SupabaseService();\r\n","\n// 2.2 Supabase Database Schema Mappings & Enums\n\nexport enum EntityStatus {\n  ACTIVE = 'active',\n  ARCHIVED = 'archived',\n}\n\nexport enum HabitWeight {\n  LOW = 1,\n  MEDIUM = 2,\n  HIGH = 4,\n}\n\nexport enum GoalType {\n  TASK_PROJECT = 'task_project',\n  CONSISTENCY_METRIC = 'consistency_metric',\n}\n\nexport enum ArchiveType {\n  ROUTINE = 'routine',\n  VISION_5Y = 'vision_5y',\n  LIFE_TODO = 'life_todo',\n  MANTRA_BANK = 'mantra_bank',\n  THEORY_NOTES = 'theory_notes',\n}\n\nexport enum SlideCategory {\n  ME = 'Me',\n  HER = 'Her',\n  PURPOSE = 'Purpose',\n  SOCIAL = 'Social',\n  MATERIAL = 'Material',\n}\n\n// -- CORE MANAGEMENT --\nexport interface Profile {\n  id: string;\n  current_version_id: string | null;\n  current_cycle_id: string | null;\n  avatar_url?: string;\n  // System Tempo Settings\n  version_days_default: number; // Default 90\n  cycles_per_version_default: number; // Default 6\n}\n\n// -- TIME MANAGEMENT --\nexport interface Version {\n  id: string;\n  number: number;\n  title: string;\n  description: string; // The \"Persona\"\n  status: EntityStatus;\n  start_date: string; // ISO Date\n  end_date: string; // ISO Date\n}\n\nexport interface CCHItem {\n  category: 'Beliefs' | 'Characteristics' | 'Skills';\n  items: string[];\n}\n\nexport interface Cycle {\n  id: string;\n  version_id: string;\n  sprint_number: number;\n  focus_priorities: string[]; // Max 3\n  problems: string;\n  cch_list: CCHItem[];\n  mantras: string[];\n  learning_focus: string;\n  start_date: string;\n  end_date: string;\n  status?: EntityStatus;\n}\n\n// -- ACTION ENGINE --\nexport interface Habit {\n  id: string;\n  cycle_id: string;\n  name: string;\n  weight: HabitWeight;\n  category: string;\n  linked_goal_id?: string;\n}\n\nexport interface HabitLog {\n  id: string;\n  habit_id: string;\n  date: string; // ISO Date \"YYYY-MM-DD\"\n  status: boolean;\n}\n\nexport interface Subtask {\n  name: string;\n  done: boolean;\n  level?: number; // 0 = root, 1 = sub, etc.\n}\n\nexport interface Goal {\n  id: string;\n  cycle_id: string;\n  title: string;\n  description: string;\n  type: GoalType;\n  // For Projects\n  subtasks?: Subtask[]; \n  // For Metrics\n  linked_habit_id?: string;\n  current_streak?: number; \n}\n\n// -- KNOWLEDGE & ARCHIVES --\nexport interface ArchiveItem {\n  id: string;\n  type: ArchiveType;\n  title: string;\n  content: string;\n}\n\n// -- VISUALIZATION --\nexport interface Slide {\n  id: string;\n  category: SlideCategory;\n  image_url: string;\n  gallery_images?: string[];\n  caption: string;\n}\n\n// -- DATA TRANSFER OBJECTS FOR UI --\nexport interface DashboardData {\n  version: Version | null;\n  cycle: Cycle | null;\n  habits: Habit[];\n  todayLogs: HabitLog[];\n  habitStats: Record<string, { currentStreak: number; maxStreak: number }>;\n  goals: Goal[];\n}\n"],"names":["EntityStatus","HabitWeight","GoalType","ArchiveType","SlideCategory"],"mappings":"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","ignoreList":[0,1]}