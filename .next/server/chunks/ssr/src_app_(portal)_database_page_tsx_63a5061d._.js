module.exports=[93731,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(24129),e=a.i(11366),f=a.i(20494),g=a.i(81560),h=a.i(68976),i=a.i(33508),j=a.i(14548),k=a.i(46201),l=a.i(60283),m=a.i(81528);let n=({isOpen:a,onClose:d,type:f,data:g,onSave:h,categories:k})=>{let[l,m]=(0,c.useState)(g);if((0,c.useEffect)(()=>{m(g)},[g]),!a||!l)return null;let n=(a,b)=>{m(c=>({...c,[a]:b}))};return(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-graphite-950/80 backdrop-blur-sm p-4",onClick:d,children:(0,b.jsxs)("div",{className:"w-full max-w-lg rounded-2xl bg-white dark:bg-graphite-900 p-6 shadow-2xl border border-graphite-200 dark:border-graphite-800 animate-in zoom-in-95 duration-200",onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,b.jsxs)("h2",{className:"text-lg font-bold text-graphite-900 dark:text-white capitalize",children:["Edit ",f.slice(0,-1)]}),(0,b.jsx)("button",{onClick:d,children:(0,b.jsx)(i.X,{size:20,className:"text-graphite-400 hover:text-white"})})]}),(0,b.jsx)("div",{className:"space-y-4 mb-6",children:"versions"===f?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-xs font-bold uppercase text-graphite-500",children:"Title"}),(0,b.jsx)("input",{className:"w-full bg-graphite-50 dark:bg-graphite-800 border border-graphite-200 dark:border-graphite-700 rounded-lg p-2 text-sm",value:l.title,onChange:a=>n("title",a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-xs font-bold uppercase text-graphite-500",children:"Description"}),(0,b.jsx)("textarea",{className:"w-full bg-graphite-50 dark:bg-graphite-800 border border-graphite-200 dark:border-graphite-700 rounded-lg p-2 text-sm",value:l.description,onChange:a=>n("description",a.target.value),rows:3})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-xs font-bold uppercase text-graphite-500",children:"Start Date"}),(0,b.jsx)("input",{type:"date",className:"w-full bg-graphite-50 dark:bg-graphite-800 border border-graphite-200 dark:border-graphite-700 rounded-lg p-2 text-sm",value:l.start_date,onChange:a=>n("start_date",a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-xs font-bold uppercase text-graphite-500",children:"End Date"}),(0,b.jsx)("input",{type:"date",className:"w-full bg-graphite-50 dark:bg-graphite-800 border border-graphite-200 dark:border-graphite-700 rounded-lg p-2 text-sm",value:l.end_date,onChange:a=>n("end_date",a.target.value)})]})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-xs font-bold uppercase text-graphite-500",children:"Status"}),(0,b.jsxs)("select",{className:"w-full bg-graphite-50 dark:bg-graphite-800 border border-graphite-200 dark:border-graphite-700 rounded-lg p-2 text-sm",value:l.status,onChange:a=>n("status",a.target.value),children:[(0,b.jsx)("option",{value:e.EntityStatus.ACTIVE,children:"Active"}),(0,b.jsx)("option",{value:e.EntityStatus.ARCHIVED,children:"Archived"})]})]})]}):null}),(0,b.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,b.jsx)("button",{onClick:d,className:"px-4 py-2 text-sm font-bold text-graphite-500 hover:text-graphite-900 dark:hover:text-white",children:"Cancel"}),(0,b.jsxs)("button",{onClick:()=>h(l),className:"px-6 py-2 bg-pacific-600 text-white rounded-xl text-sm font-bold shadow-lg shadow-pacific-500/30 flex items-center gap-2",children:[(0,b.jsx)(j.Save,{size:16})," Save Changes"]})]})]})})};a.s(["default",0,()=>{let[a,i]=(0,c.useState)([]),[j,o]=(0,c.useState)([]),[p,q]=(0,c.useState)([]),[r,s]=(0,c.useState)([]),[t,u]=(0,c.useState)("versions"),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)(null),z=async()=>{try{let a=await d.supabaseService.getAllVersions(),b=await d.supabaseService.getAllCycles(),c=await d.supabaseService.getAllHabits(),e=await d.supabaseService.getAllGoals();i(a),o(b),q(c),s(e)}catch(a){console.error(a)}};(0,c.useEffect)(()=>{z()},[]),(0,c.useEffect)(()=>{w(null)},[t]);let A=async(a,b)=>{if(v!==a){w(a),setTimeout(()=>w(b=>b===a?null:b),3e3);return}try{switch(b){case"versions":await d.supabaseService.deleteVersion(a);break;case"cycles":await d.supabaseService.deleteCycle(a);break;case"habits":await d.supabaseService.deleteHabit(a);break;case"goals":await d.supabaseService.deleteGoal(a)}w(null),z()}catch(a){console.error("Delete failed",a),z()}},B=async a=>{let b=x?.type;if(b){switch(b){case"versions":await d.supabaseService.updateVersion(a);break;case"cycles":await d.supabaseService.updateCycle(a)}y(null),z()}},C=async(a,b)=>{if(x?.type!=="goals"||!x.data)return;let c=x.data,e=a.subtasks?.map(a=>{let b=a.match(/^(\s*)/),c=Math.floor((b?b[1]:"").replace(/\t/g,"  ").length/2);return{name:a.trim(),done:!1,level:c}}),f={...c,title:a.title,description:a.description,type:a.type,subtasks:e,linked_habit_id:b?.id};await d.supabaseService.updateGoal(f),y(null),z()},D=async a=>{if(x?.type!=="habits"||!x.data)return;let b={...x.data,name:a.name,category:a.category,weight:a.weight};await d.supabaseService.updateHabit(b),y(null),z()},E=async(a,b)=>{if(x?.data){if("delete"===a)await d.supabaseService.deleteGoal(b.id);else if("create"===a){let a={id:`g-${crypto.randomUUID()}`,cycle_id:x.data.id,title:b.title,description:b.description,type:b.type,subtasks:b.subtasks?.map(a=>({name:a.trim(),done:!1,level:0}))||[]};await d.supabaseService.addGoal(a)}else{let a=r.find(a=>a.id===b.id);if(a){let c={...a,...b};b.subtasks&&"string"==typeof b.subtasks[0]&&(c.subtasks=b.subtasks.map(a=>({name:a.trim(),done:!1,level:0}))),await d.supabaseService.updateGoal(c)}}z()}},F=async(a,b)=>{if(x?.data){if("delete"===a)await d.supabaseService.deleteHabit(b.id);else if("create"===a){let a={id:`h-${crypto.randomUUID()}`,cycle_id:x.data.id,name:b.name,category:b.category,weight:b.weight};await d.supabaseService.addHabit(a)}else{let a=p.find(a=>a.id===b.id);a&&await d.supabaseService.updateHabit({...a,...b})}z()}},G=Array.from(new Set(p.map(a=>a.category))).sort(),H=j.find(a=>a.status===e.EntityStatus.ACTIVE)||j[j.length-1],I=H?p.filter(a=>a.cycle_id===H.id):[];return(0,b.jsxs)("div",{className:"space-y-8 h-full flex flex-col",children:[(0,b.jsx)("header",{className:"flex items-end justify-between border-b border-graphite-200 dark:border-graphite-800 pb-6",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xs font-bold uppercase tracking-widest text-graphite-500 mb-2",children:"System Records"}),(0,b.jsxs)("h1",{className:"text-3xl font-display font-medium text-graphite-900 dark:text-white flex items-center gap-3",children:[(0,b.jsx)(f.Database,{className:"text-graphite-400"}),"Database View"]})]})}),(0,b.jsx)("div",{className:"flex gap-4 border-b border-graphite-200 dark:border-graphite-800",children:["versions","cycles","habits","goals"].map(a=>(0,b.jsx)("button",{onClick:()=>u(a),className:`pb-3 text-sm font-bold uppercase tracking-wide transition-colors border-b-2 ${t===a?"border-pacific-500 text-pacific-700 dark:border-pacific-400 dark:text-pacific-400":"border-transparent text-graphite-500 hover:text-graphite-700 dark:hover:text-graphite-300"}`,children:a},a))}),(0,b.jsxs)("div",{className:"flex-1 overflow-auto bg-white dark:bg-graphite-900 border border-graphite-200 dark:border-graphite-800 rounded-lg shadow-sm",children:[(()=>{let c=[],d=[];switch(t){case"versions":c=["Number","Title","Status","Dates","Actions"],d=a.map(a=>({id:a.id,data:[(0,b.jsxs)("span",{className:"font-medium",children:["v",a.number,".0"]}),a.title,(0,b.jsx)("span",{className:`px-2 py-1 rounded text-xs font-bold uppercase ${a.status===e.EntityStatus.ACTIVE?"bg-bali-100 text-bali-700 dark:bg-bali-900/30 dark:text-bali-400":"bg-graphite-100 text-graphite-500 dark:bg-graphite-800"}`,children:a.status}),(0,b.jsxs)("span",{className:"text-xs font-mono text-graphite-500",children:[a.start_date," → ",a.end_date]})],original:a}));break;case"cycles":c=["Sprint #","Priorities","Version Link","Dates","Actions"],d=j.map(a=>({id:a.id,data:[`Cycle ${a.sprint_number}`,(0,b.jsx)("div",{className:"flex flex-col gap-1",children:a.focus_priorities.slice(0,2).map((a,c)=>(0,b.jsxs)("span",{className:"text-xs",children:["• ",a]},c))}),(0,b.jsx)("span",{className:"text-xs text-pacific-500 font-mono",children:a.version_id}),(0,b.jsxs)("span",{className:"text-xs font-mono text-graphite-500",children:[a.start_date," → ",a.end_date]})],original:a}));break;case"habits":c=["Name","Category","Weight","Cycle Link","Actions"],d=p.map(a=>({id:a.id,data:[(0,b.jsx)("span",{className:"font-medium",children:a.name}),(0,b.jsx)("span",{className:"text-xs bg-graphite-100 dark:bg-graphite-800 px-2 py-1 rounded",children:a.category}),(0,b.jsx)("div",{className:"flex gap-0.5",children:[...Array(a.weight)].map((a,c)=>(0,b.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-pacific-500"},c))}),(0,b.jsx)("span",{className:"text-xs text-pacific-500 font-mono",children:a.cycle_id})],original:a}));break;case"goals":c=["Title","Type","Cycle Link","Linked Habit","Actions"],d=r.map(a=>({id:a.id,data:[(0,b.jsx)("span",{className:"font-medium",children:a.title}),(0,b.jsx)("span",{className:`text-[10px] font-bold uppercase px-2 py-1 rounded border ${a.type===e.GoalType.TASK_PROJECT?"border-purple-200 text-purple-600 dark:border-purple-900 dark:text-purple-400":"border-bali-200 text-bali-600 dark:border-bali-900 dark:text-bali-400"}`,children:a.type===e.GoalType.TASK_PROJECT?"Project":"Consistency"}),(0,b.jsx)("span",{className:"text-xs text-pacific-500 font-mono",children:a.cycle_id}),a.linked_habit_id?(0,b.jsxs)("span",{className:"text-xs font-mono text-graphite-400",children:[a.linked_habit_id.slice(0,8),"..."]}):(0,b.jsx)("span",{className:"text-xs text-graphite-300",children:"-"})],original:a}))}return(0,b.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,b.jsx)("thead",{className:"bg-graphite-50 dark:bg-graphite-800/50 text-graphite-500 uppercase font-bold text-xs sticky top-0 backdrop-blur-sm",children:(0,b.jsx)("tr",{children:c.map((a,c)=>(0,b.jsx)("th",{className:"px-6 py-3",children:a},c))})}),(0,b.jsx)("tbody",{className:"divide-y divide-graphite-200 dark:divide-graphite-800",children:d.map(a=>(0,b.jsxs)("tr",{className:"hover:bg-graphite-50 dark:hover:bg-graphite-800/30 transition-colors group",children:[a.data.map((a,c)=>(0,b.jsx)("td",{className:"px-6 py-4 text-graphite-700 dark:text-graphite-300 align-middle",children:a},c)),(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,b.jsx)("button",{onClick:()=>{y({type:t,data:a.original})},className:"p-1.5 text-graphite-400 hover:text-pacific-500 hover:bg-pacific-50 dark:hover:bg-pacific-900/20 rounded-lg transition-colors",children:(0,b.jsx)(h.Edit3,{size:16})}),(0,b.jsxs)("button",{onClick:()=>A(a.id,t),className:`p-1.5 rounded-lg transition-all duration-200 flex items-center gap-2 ${v===a.id?"bg-red-500 text-white px-3 shadow-lg shadow-red-500/30 opacity-100":"text-graphite-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20"}`,children:[(0,b.jsx)(g.Trash2,{size:16}),v===a.id&&(0,b.jsx)("span",{className:"text-xs font-bold animate-in fade-in slide-in-from-left-1",children:"Confirm"})]})]})})]},a.id))})]})})(),("versions"===t&&0===a.length||"cycles"===t&&0===j.length||"habits"===t&&0===p.length||"goals"===t&&0===r.length)&&(0,b.jsx)("div",{className:"p-12 text-center text-graphite-400 italic",children:"No records found in database."})]}),x&&("goals"===x.type?(0,b.jsx)(k.GoalFormModal,{isOpen:!0,onClose:()=>y(null),onSave:C,initialGoal:x.data,allHabits:p,currentCycleHabits:I}):"cycles"===x.type?(0,b.jsx)(l.CycleEditorModal,{cycle:x.data,goals:r.filter(a=>a.cycle_id===x.data.id),habits:p.filter(a=>a.cycle_id===x.data.id),allHabits:p,onClose:()=>y(null),onSaveCycle:B,onManageGoal:E,onManageHabit:F,onRenameCategory:async(a,b)=>{for(let c of(await d.supabaseService.getAllHabits()).filter(b=>b.category===a))await d.supabaseService.updateHabit({...c,category:b});await z()},onDeleteCategory:async a=>{for(let b of(await d.supabaseService.getAllHabits()).filter(b=>b.category===a))await d.supabaseService.updateHabit({...b,category:"Uncategorized"});await z()}}):"habits"===x.type?(0,b.jsx)(m.HabitFormModal,{isOpen:!0,onClose:()=>y(null),onSave:D,initialHabit:x.data,allHabits:p,onDeleteFromLibrary:a=>A(a,"habits"),onRenameCategory:async(a,b)=>{for(let c of(await d.supabaseService.getAllHabits()).filter(b=>b.category===a))await d.supabaseService.updateHabit({...c,category:b});await z()},onDeleteCategory:async a=>{for(let b of(await d.supabaseService.getAllHabits()).filter(b=>b.category===a))await d.supabaseService.updateHabit({...b,category:"Uncategorized"});await z()}}):(0,b.jsx)(n,{isOpen:!!x,onClose:()=>y(null),type:x.type,data:x.data,onSave:B,categories:G}))]})}])}];

//# sourceMappingURL=src_app_%28portal%29_database_page_tsx_63a5061d._.js.map